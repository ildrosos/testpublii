{
    "version": "https://jsonfeed.org/version/1",
    "title": "Drontoso",
    "description": "",
    "home_page_url": "https://drontoso.gr",
    "feed_url": "https://drontoso.gr/feed.json",
    "user_comment": "",
    "icon": "https://drontoso.gr/media/website/DrontosoBlogLogoAINoBG.png",
    "author": {
        "name": "Ilias Drosos"
    },
    "items": [
        {
            "id": "https://drontoso.gr/imap-migration-yahoo-free-accounts-to-microsoft-365/",
            "url": "https://drontoso.gr/imap-migration-yahoo-free-accounts-to-microsoft-365/",
            "title": "IMAP migration -  Yahoo (free) accounts to Microsoft 365 fails!",
            "summary": "Are you trying to migrate IMAP Yahoo accounts to 365 and get errors ? Like incorrect username or password ? Follow these steps :&nbsp; If you are trying to create the migration endpoint for IMAP migrations to your Microsoft 365 tenant remember to use the&hellip;",
            "content_html": "\n  <p>\n    Are you trying to migrate IMAP Yahoo accounts to 365 and get errors ? Like incorrect username or password ? Follow these steps :&nbsp;\n  </p>\n\n  <p>\n    \n  </p>\n\n  <p>\n    If you are trying to create the migration endpoint for IMAP migrations to your Microsoft 365 tenant remember to use the settings below :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/24/MigrateImapEndpointSettings.png\" height=\"521\" width=\"307\" alt=\"MigrationEndpoint Settings IMAP server\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-xs.png 300w ,https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-sm.png 480w ,https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-md.png 768w ,https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-lg.png 1024w ,https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-xl.png 1360w ,https://drontoso.gr/media/posts/24/responsive/MigrateImapEndpointSettings-2xl.png 1600w\">\n      \n    </figure>\n\n  <ul>\n    <li>Next you will need to create your 365 users</li><li>Assign a license to the users</li><li>And finally prepare the CSV file&nbsp;&nbsp;</li>\n  </ul>\n\n  <p>\n    About the CSV file be careful with the columns :&nbsp;\n  </p>\n\n  <p>\n    Email address: column is your destination 365 mailbox email address.\n  </p>\n\n  <p>\n    Username: is your Yahoo account username without @ sign or anything else.\n  </p>\n\n  <p>\n    Password:Is your account's app password&nbsp; .\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/24/CSV.png\" height=\"45\" width=\"664\" alt=\"CSV details\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/24/responsive/CSV-xs.png 300w ,https://drontoso.gr/media/posts/24/responsive/CSV-sm.png 480w ,https://drontoso.gr/media/posts/24/responsive/CSV-md.png 768w ,https://drontoso.gr/media/posts/24/responsive/CSV-lg.png 1024w ,https://drontoso.gr/media/posts/24/responsive/CSV-xl.png 1360w ,https://drontoso.gr/media/posts/24/responsive/CSV-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    \n  </p>\n\n  <p>\n    If you try to use your password instead you will get multiple errors . Go ahead and create an app password on this link&nbsp; : <a href=\"https://login.yahoo.com/myaccount/security/app-password/?intl=us&amp;lang=el-GR&amp;src=member-center&amp;activity=ybar-acctOverview&amp;pspid=794264123&amp;theme=light&amp;done=https%3A%2F%2Flogin.yahoo.com%2Fmyaccount%2Foverview%2F%3Fsrc%3Dym%26.done%3Dhttps%253A%252F%252Fmail.yahoo.com%252F%253F.intl%253Dgr%2526.lang%253Del-GR%26pspid%3D159628501%26activity%3Dybar-acctinfo%26.scrumb%3DJIurewD6tGX&amp;scrumb=e1Y.HyJAjDK&amp;backTo=%2Fsecurity%2F%3Fintl%3Dus%26lang%3Del-GR%26src%3Dmember-center%26activity%3Dybar-acctOverview%26pspid%3D794264123%26theme%3Dlight%26done%3Dhttps%253A%252F%252Flogin.yahoo.com%252Fmyaccount%252Foverview%252F%253Fsrc%253Dym%2526.done%253Dhttps%25253A%25252F%25252Fmail.yahoo.com%25252F%25253F.intl%25253Dgr%252526.lang%25253Del-GR%2526pspid%253D159628501%2526activity%253Dybar-acctinfo%2526.scrumb%253DJIurewD6tGX%26scrumb%3De1Y.HyJAjDK%26anchorId%3DappPasswordCard\">AppPasswordsCreation</a>\n  </p>\n\n  <p>\n    After creating the app password write it down in your CSV file in Password column and Start your migration batch.&nbsp;\n  </p>",
            "image": "https://drontoso.gr/media/posts/24/YahoomailIMAPMigrationFailed.jpeg",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "M365Migration",
                   "Exchange"
            ],
            "date_published": "2024-07-09T17:08:33+03:00",
            "date_modified": "2024-07-09T17:09:50+03:00"
        },
        {
            "id": "https://drontoso.gr/windows-hello-for-business-pin-reset-client-service-production-applications-are-not-working-as-expected/",
            "url": "https://drontoso.gr/windows-hello-for-business-pin-reset-client-service-production-applications-are-not-working-as-expected/",
            "title": "Windows Hello for Business Pin Reset Client / Service Production Applications are not working as expected - PIN reset is not working on Hybrid Joined devices.",
            "summary": "If you are trying to deploy the applications published from Microsoft to enable Pin Reset from lockscreen on your Entra ID Joined / Entra Hybrid Joined devices you are probably reading this article : https://learn.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/pin-reset?tabs=intune Following the guide to enable the PIN reset you need&hellip;",
            "content_html": "<p>If you are trying to deploy the applications published from Microsoft to enable Pin Reset from lockscreen on your Entra ID Joined / Entra Hybrid Joined devices you are probably reading this article : </p>\n<p><a href=\"https://learn.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/pin-reset?tabs=intune\">https://learn.microsoft.com/en-us/windows/security/identity-protection/hello-for-business/pin-reset?tabs=intune</a></p>\n<p>Following the guide to enable the PIN reset you need to register two applications :</p>\n<p> <a href=\"https://login.windows.net/common/oauth2/authorize?response_type=code&amp;client_id=b8456c59-1230-44c7-a4a2-99b085333e84&amp;resource=https%3A%2F%2Fgraph.windows.net&amp;redirect_uri=https%3A%2F%2Fcred.microsoft.com&amp;state=e9191523-6c2f-4f1d-a4f9-c36f26f89df0&amp;prompt=admin_consent\" data-linktype=\"external\">Microsoft PIN Reset Service Production website</a></p>\n<p>and</p>\n<p><a href=\"https://login.windows.net/common/oauth2/authorize?response_type=code&amp;client_id=9115dd05-fad5-4f9c-acc7-305d08b1b04e&amp;resource=https%3A%2F%2Fcred.microsoft.com%2F&amp;redirect_uri=ms-appx-web%3A%2F%2FMicrosoft.AAD.BrokerPlugin%2F9115dd05-fad5-4f9c-acc7-305d08b1b04e&amp;state=6765f8c5-f4a7-4029-b667-46a6776ad611&amp;prompt=admin_consent\" data-linktype=\"external\">Microsoft PIN Reset Client Production website</a></p>\n<p>After logging in you see the prompts published in the article but at the next step you get an error about the Reply URL for the Service Production Website and a \"white\" screen for the Client Production website . </p>\n<p>That doesn't mean the apps are not deployed but they are not deployed as they should .</p>\n<p>Some information and permissions are missing . </p>\n<p><strong>So next step will be to go the apps and Grant admin permissions . Even you don't see any permissions underneath Grant admin consent and wait 2-5 minutes . After 5 minutes approximately permissions will appear and the apps will be ready to be used.</strong></p>\n<p>For reference here are the IDs of the correct apps :  Microsoft Pin Reset Client Production application </p>\n<table class=\"azc-grid-full\" style=\"width: 100%; height: 50.3594px;\" role=\"presentation\" data-bind=\"style: { width: $ctl.tableWidth }\">\n<tbody class=\"azc-grid-groupdata\" role=\"rowgroup\">\n<tr class=\"fxs-portal-hover fxs-portal-focus azc-grid-row\" style=\"height: 50.3594px;\" tabindex=\"0\" role=\"row\" data-bind=\"'keyedCss':{ grid1BodyRowsCore:&quot;azc-grid-row &quot;+ cssClass()},'attr':{'aria-label':$ctl._getRowAriaLabel($data) &amp;&amp; ariaLabel(),'aria-rowindex':$ctl.getRowIndex($index()),'aria-disabled':$disabled,'data-grid-focusable':true,'tabindex':focused() ? $ctl.$tabIndex():'-1'},'css':{&quot;azc-row-disabled&quot;:$disabled}\" aria-rowindex=\"1\" data-grid-focusable=\"true\">\n<td class=\"azc-grid-cell azc-br-muted\" style=\"width: 99.8575%; height: 50.3594px;\" role=\"gridcell\" data-bind=\"template: { name: &quot;bodyCellContent&quot; }, css: { &quot;azc-collapsed-hidden&quot;: $data.hiddenInCollapsed }, keyedCss: { grid1BodyCell: &quot;azc-grid-cell azc-br-muted &quot; + cssClass + (itemKey === &quot;infoBalloon&quot; ? &quot;azc-grid-infoBalloon&quot; : &quot;&quot;)}, attr: { &quot;aria-describedby&quot;: columnId, &quot;aria-label&quot;: $ctl._getCellAriaLabel($parent, $data) &amp;&amp; $parent.cellAriaLabels[itemKey](), &quot;aria-colindex&quot; : $index() + 1, &quot;aria-rowindex&quot;: $ctl.getRowIndex($parentContext.$index()), &quot;aria-readonly&quot;: $ctl._ariaReadonly }\" aria-describedby=\"fxgridcol5\" aria-colindex=\"3\" aria-rowindex=\"1\" aria-readonly=\"true\">\n<div class=\"azc-grid-cellContent\" title=\"9115dd05-fad5-4f9c-acc7-305d08b1b04e\" data-bind=\"css: { &quot;azc-grid-cell-ellipse&quot;: $data.enableEllipse, &quot;azc-grid-cell-fullheight&quot;: $data.fullHeight }, trustedCellBinding: $ctl._cellFormat($parentContext.$parentContext.$index, $index, $parent, $data)\">9115dd05-fad5-4f9c-acc7-305d08b1b04e</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>Microsoft Pin Reset Service  Production Application</p>\n<table class=\"azc-grid-full\" style=\"width: 100%; height: 50.3594px;\" role=\"presentation\" data-bind=\"style: { width: $ctl.tableWidth }\">\n<tbody class=\"azc-grid-groupdata\" role=\"rowgroup\">\n<tr class=\"fxs-portal-hover fxs-portal-focus azc-grid-row\" style=\"height: 50.3594px;\" tabindex=\"0\" role=\"row\" data-bind=\"'keyedCss':{ grid1BodyRowsCore:&quot;azc-grid-row &quot;+ cssClass()},'attr':{'aria-label':$ctl._getRowAriaLabel($data) &amp;&amp; ariaLabel(),'aria-rowindex':$ctl.getRowIndex($index()),'aria-disabled':$disabled,'data-grid-focusable':true,'tabindex':focused() ? $ctl.$tabIndex():'-1'},'css':{&quot;azc-row-disabled&quot;:$disabled}\" aria-rowindex=\"1\" data-grid-focusable=\"true\">\n<td class=\"azc-grid-cell azc-br-muted\" style=\"width: 99.8575%; height: 50.3594px;\" role=\"gridcell\" data-bind=\"template: { name: &quot;bodyCellContent&quot; }, css: { &quot;azc-collapsed-hidden&quot;: $data.hiddenInCollapsed }, keyedCss: { grid1BodyCell: &quot;azc-grid-cell azc-br-muted &quot; + cssClass + (itemKey === &quot;infoBalloon&quot; ? &quot;azc-grid-infoBalloon&quot; : &quot;&quot;)}, attr: { &quot;aria-describedby&quot;: columnId, &quot;aria-label&quot;: $ctl._getCellAriaLabel($parent, $data) &amp;&amp; $parent.cellAriaLabels[itemKey](), &quot;aria-colindex&quot; : $index() + 1, &quot;aria-rowindex&quot;: $ctl.getRowIndex($parentContext.$index()), &quot;aria-readonly&quot;: $ctl._ariaReadonly }\" aria-describedby=\"fxgridcol5\" aria-colindex=\"3\" aria-rowindex=\"1\" aria-readonly=\"true\">\n<div class=\"azc-grid-cellContent\" title=\"9115dd05-fad5-4f9c-acc7-305d08b1b04e\" data-bind=\"css: { &quot;azc-grid-cell-ellipse&quot;: $data.enableEllipse, &quot;azc-grid-cell-fullheight&quot;: $data.fullHeight }, trustedCellBinding: $ctl._cellFormat($parentContext.$parentContext.$index, $index, $parent, $data)\">b8456c59-1230-44c7-a4a2-99b085333e84</div>\n</td>\n</tr>\n</tbody>\n</table>\n<p>This is the result , notice that only one of them has a Homepage URL : </p>\n<figure class=\"post__image\"><img loading=\"lazy\"  src=\"https://drontoso.gr/media/posts/22/Microsoft-PIN-reset.png\" alt=\"Pin reset snip\" width=\"1623\" height=\"94\" sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-xs.png 300w ,https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-sm.png 480w ,https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-md.png 768w ,https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-lg.png 1024w ,https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-xl.png 1360w ,https://drontoso.gr/media/posts/22/responsive/Microsoft-PIN-reset-2xl.png 1600w\"></figure>\n<p>Now retry resetting the PIN from the lockscreen on your devices .</p>\n<p>Don't forget to exclude these two enterprise Apps from any conditional access policies which enforce MFA (if you have policies with all apps selected exclude only these two) as they seem to interfere with the process and they are totally unnecessary since MFA is enforced either way .</p>\n<p>In my tests on Windows 10 it works perfectly fine but on Windows 11 the button Forgot My PIN does nothing . I read this is a known behavior and to workaround it you need to follow these steps : </p>\n<ul>\n<li>Chose \"Other User\"</li>\n<li>Switch to PIN code </li>\n<li>Enter the username of the user (without @domain.com)</li>\n<li>Finally</li>\n<li>Click on PIN Reset<br><br></li>\n</ul>\n<p>This will guide you to start the PIN reset process by entering your password first etc.</p>\n<p> </p>",
            "image": "https://drontoso.gr/media/posts/22/Win11LockScreenPINReset1.jpeg",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "Microsoft Intune"
            ],
            "date_published": "2024-07-02T15:30:40+03:00",
            "date_modified": "2024-07-03T10:51:59+03:00"
        },
        {
            "id": "https://drontoso.gr/microsoft-baselines-gpo-intune-windows-baselines-break-miracast-functionality/",
            "url": "https://drontoso.gr/microsoft-baselines-gpo-intune-windows-baselines-break-miracast-functionality/",
            "title": "Microsoft Baselines (GPO) / Intune Windows Baselines break Miracast Functionality (connect to a wireless display).",
            "summary": "Recently I run into a problem with one of my customers . After deploying the latest MIcrosoft Windows Baselines users were not able to use Connect to wireless diplay. I suspected that something in the baselines broke this functionality so I started searching within the&hellip;",
            "content_html": "<p>Recently I run into a problem with one of my customers . After deploying the latest MIcrosoft Windows Baselines users were not able to use Connect to wireless diplay.</p>\n<p>I suspected that something in the baselines broke this functionality so I started searching within the settings.</p>\n<p>The documentation provided did not mention miracast or cast at all so I decided to disable the settings , first the ones I thought that could lead to such a problem and later the others . </p>\n<p>Well if you are in the same situation search no more . </p>\n<p>After 2 hours of searching I found out that none of the settings I thought broke the functionality . The problem was Windows firewall. If you haven't enabled Windows firewall on your clients and apply the policies then windows firewall will be turned on .</p>\n<p>But to find the exact process to exclude you need to know which that is and which firewall profile it is using . </p>\n<p>After all when you click on connect to a wireless display it turns out your computer is using wi-fi adapter to connect to a hotspot your television is broadcasting. That said the profile to change is the firewall Public profile since this is the network that is recognized as a public connection when your computer makes a direct connection with the TV/Screen to cast. </p>\n<p>So go and make an inbound exception on your firewall profile either from GPO/Intune/Manually for the app : </p>\n<ul>\n<li>Program %systemroot%/system32/WUDFHost.exe</li>\n<li>Protocol: TCP</li>\n</ul>\n<p>This should do the trick!</p>",
            "image": "https://drontoso.gr/media/posts/21/Connect-to-wireless-display.jpg",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "Microsoft Baselines"
            ],
            "date_published": "2024-03-16T00:57:36+02:00",
            "date_modified": "2024-03-16T12:47:00+02:00"
        },
        {
            "id": "https://drontoso.gr/system-center-operations-manager-2016-to-2019-upgrade-error-scom-2019/",
            "url": "https://drontoso.gr/system-center-operations-manager-2016-to-2019-upgrade-error-scom-2019/",
            "title": "System Center Operations Manager 2016 to 2019 in-place Upgrade Error (SCOM 2019) ",
            "summary": "While upgrading a SCOM 2016 instance to 2019 I came up to a strange error . While checking the prerequisites I verified that my 2016 SQL SP3 server was enough to proceed with the the installation . But while starting the installation I got an&hellip;",
            "content_html": "<p> </p>\n<p>While upgrading a SCOM 2016 instance to 2019 I came up to a strange error . While checking the prerequisites I verified that my 2016 SQL SP3 server was enough to proceed with the the installation . </p>\n<p>But while starting the installation I got an error in prerequisites check which stated that SQL version was not compatible with the current version I was trying to install . </p>\n<p>After finding the log folder of the installation I was running (C:\\Users\\userusedduringinstallation\\AppData\\Local\\SCOM\\LOGS) I opened SCOMPrereqCheck to check for more details . </p>\n<p>Unfortunately this log file has an XML like structure which does not provide more details to identify the root cause of this error . The only thing I found was a line stating OMDBSqlVersionCheckTitle with a Fail word in the end . </p>\n<p>Then I decided to check what was happening during the prerequisites check in my SQL server . So I fired Up SQL Management Studio logged in  and opened Management -&gt; SQL Server Logs -&gt; and opened the current logs file . </p>\n<p>There I saw a line saying : </p>\n<p>Starting up database 'SCOMINSTALLTESTDB_638356414323093873'.</p>\n<p>Each time I fired up the prerequisites check again on my SCOM server another database log was recorded . So to check if the server version is correct SCOM installer creates a test database with a random number in the end. I also checked that the account used during installation had the required permissions on the SQL server so that was not the issue. </p>\n<p>Then I decided to dig more . So I opened another log file through SQL Log viewer console which is called Windows NT . </p>\n<p>There I saw an error saying : </p>\n<p>The server-side authentication level policy does not allow the user DOMAIN\\USER SID (S-1-X-XX-XXXXXXXXXX-XXXXXXXXX-XXXXXXXXX-XXXXX) from address XX.XX.XX.XX to activate DCOM server. Please raise the activation authentication level at least to RPC_C_AUTHN_LEVEL_PKT_INTEGRITY in client application.</p>\n<p>I verified the IP listed here was the IP of my SCOM server . </p>\n<p>After googling the error I came up to this result : </p>\n<p><a href=\"https://support.microsoft.com/en-us/topic/kb5004442-manage-changes-for-windows-dcom-server-security-feature-bypass-cve-2021-26414-f1400b52-c141-43d2-941e-37ed901c769c\">https://support.microsoft.com/en-us/topic/kb5004442-manage-changes-for-windows-dcom-server-security-feature-bypass-cve-2021-26414-f1400b52-c141-43d2-941e-37ed901c769c</a></p>\n<p>If you read the article you will end up installing the KB on your SQL server or adding the registry key specified with a value of 0 to bypass the error . I did the latter and restarted the SQL server since it is required for the reg change to work . </p>\n<p>Fired up prerequisites check again and the error was gone! Voila! </p>\n<p>P.S. That registry key imposes your server and infrastructure in a security risk . Please keep in mind to remove the registry key or find a workaround after installing your SCOM instance. </p>",
            "image": "https://drontoso.gr/media/posts/20/20162019featured-3.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "SCOM"
            ],
            "date_published": "2023-11-15T12:58:39+02:00",
            "date_modified": "2023-12-05T16:37:45+02:00"
        },
        {
            "id": "https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/",
            "url": "https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/",
            "title": "Hybrid Configuration wizard - No Valid Certificates Found",
            "summary": "Recently I had a case where a customer wanted to add a second exchange server in HCW to host receive and send connectors for redundancy .&nbsp; The problem was that the server was in a different site and child domain than the \"primary\" exchange server&hellip;",
            "content_html": "\n  <p>\n    Recently I had a case where a customer wanted to add a second exchange server in HCW to host receive and send connectors for redundancy .&nbsp;\n  </p>\n\n  <p>\n    The problem was that the server was in a different site and child domain than the \"primary\" exchange server which was already part of HCW.&nbsp;\n  </p>\n\n  <p>\n    As shown in the screenshot after selecting which servers you need to host Receive/Send connectors you need to select the Transport Certificate which will be used when connecting to Office 365.&nbsp;\n  </p>\n\n  <p>\n    At this point I had the error : No valid certificates found for our 1st exchange server .&nbsp;\n  </p>\n\n  <p>\n    After checking the server I identified that this was not true . The server had a valid cert and of course if you tried to run HCW from that server the error was gone.&nbsp;\n  </p>\n\n  <p>\n    So what is the problem in this case ? The problem is that HCW is trying to query the server with the hostname as shown in the screenshot not the FQDN . But as mentioned the HCW was run in a different domain than the domain that the server in question was installed to . That said the hostname was not resolved to a real IP address .\n  </p>\n\n  <p>\n    So to overcome the problem you need to either&nbsp; :&nbsp;\n  </p>\n\n  <p>\n    Add a record to your local DNS server with the server name and the server IP or&nbsp;\n  </p>\n\n  <p>\n    Add a hostfile&nbsp; to your exchange server which will point to the real IP of the server we are looking for like this :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/17/ostfile.png\" height=\"305\" width=\"513\" alt=\"hostfile\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/17/responsive/ostfile-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/ostfile-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/ostfile-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/ostfile-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/ostfile-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/ostfile-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    After that if you did not close the HCW you will see this instead of the initial error :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/17/HCW-WAITING.png\" height=\"590\" width=\"608\" alt=\"HCW - waiting\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    I gave it about 30 mins with no result so I decided to make a coffee , and close and reopen HCW wizard after about 30 mins or so . This was the result :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/17/HCW-BOOOOM.png\" height=\"508\" width=\"566\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    Boom , case closed. Cheers!\n  </p>",
            "image": "https://drontoso.gr/media/posts/17/HCW-CertNotFound-3.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "Hybrid Configuration Wizard",
                   "Exchange"
            ],
            "date_published": "2023-05-05T12:31:54+03:00",
            "date_modified": "2023-05-05T13:15:48+03:00"
        },
        {
            "id": "https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/",
            "url": "https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/",
            "title": "ADConnect Error - DeletingLicensedGroupNotAllowed",
            "summary": "If you ever delete a group in Azure AD which is used for Group Licensing purposes you will receive an error in ADConnect similar to the screenshot above .&nbsp; The error states : \"DeletingLicensedGroupNotAllowed\" The problem is that AD Connect does not specifically tell you&hellip;",
            "content_html": "\n  <p>\n    \n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect.png\" height=\"517\" width=\"1025\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-xs.png 300w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-sm.png 480w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-md.png 768w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-lg.png 1024w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-xl.png 1360w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-2xl.png 1600w\">\n      <figcaption>DeletingLicensedGroupNotAllowed</figcaption>\n    </figure>\n\n  <p>\n    If you ever delete a group in Azure AD which is used for Group Licensing purposes you will receive an <b>error</b> in <b>ADConnect </b>similar to the screenshot above .&nbsp;\n  </p>\n\n  <p>\n    The error states : \"<b>DeletingLicensedGroupNotAllowed</b>\"\n  </p>\n\n  <p>\n    The problem is that AD Connect does not specifically tell you which AD Group caused the problem. In most situations you realise you have an error in AD Connect a few hours or days later .&nbsp;\n  </p>\n\n  <p>\n    What if it was Azure Active Directory clean up day and you deleted 200 groups ? How can I find which group is causing the problem ?&nbsp;&nbsp;\n  </p>\n\n  <p>\n    \n  </p>\n\n  <p>\n    Navigate to <b>Azure Active Directory</b> - &gt; <b>Groups </b>and then <b>Audit Logs </b>.&nbsp;\n  </p>\n\n  <p>\n    Click add <b>filters </b>and add <b>Status</b> . Then choose <b>failure </b>for <b>status </b>. Obviously within the failures you will find the one you are looking for . To resolve the error <b>remove the license assignment from the group</b> so the group can be deleted.\n  </p>",
            "image": "https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect-2.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "ADConnect"
            ],
            "date_published": "2023-01-13T09:38:06+02:00",
            "date_modified": "2023-05-05T13:15:54+03:00"
        },
        {
            "id": "https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/",
            "url": "https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/",
            "title": "Automatically package and install Windows Apps to Intune Devices (without Microsoft Win32 Content Prep Tool) - intunepckgr.com",
            "summary": "What if I told you that there is a service which can package and install all popular Windows Apps as Win32 Apps to your Intune Devices with just a few clicks? What if it can also maintain and automatically update the apps whenever a new&hellip;",
            "content_html": "\n  <p>\n    What if I told you that there is a service which can package and install all popular Windows Apps as Win32 Apps to your Intune Devices with just a few clicks?\n  </p>\n\n  <p>\n    What if it can also maintain and automatically update the apps whenever a new version is available ?&nbsp;\n  </p>\n\n  <p>\n    And what If the tool could do the same for all your InTune tenants ?&nbsp;\n  </p>\n\n    <blockquote class=\"blockquote\">\n      <strong>And what if you could do all of the above for free ?? (For now at least)&nbsp;</strong>\n    </blockquote>\n\n  <p>\n    Go ahead and join the beta program from&nbsp;<a href=\"https://intunepckgr.com/\" target=\"_blank\">https://intunepckgr.com/</a>\n  </p>\n\n  <p>\n    \n  </p>\n\n  <p>\n    Once joined visit your companies tab to add a new company :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/14/IntunePckgrMyCompanies.png\" height=\"602\" width=\"1381\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    Once added select it and click connect to Intune&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/14/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard.png\" height=\"237\" width=\"482\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-2xl.png 1600w\">\n      \n    </figure>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/14/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard.png\" height=\"527\" width=\"484\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    After following the prompts to sign in etc. you will be redirected back to your profile in Intunepckgr.&nbsp;\n  </p>\n\n  <p>\n    Go ahead and click on App Library&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/14/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard.png\" height=\"611\" width=\"1384\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    Select your organization and click on Add App.&nbsp;\n  </p>\n\n  <p>\n    Here you are presented with a quite large list with popular windows apps ready to be deployed. When selecting an app your are presented with the option to auto-update the app . That means that whenever a new version of the app is launched the service deploys the new version to your Intune tenant and if you have assigned the app as required for one or more groups the app gets updated on the endpoint without end-user or admin interaction!&nbsp;\n  </p>\n\n  <p>\n    After you have selected the apps of your choice wait for the app to be deployed and then head back to intune to check and assign the apps.&nbsp;\n  </p>\n\n  <p>\n    Look at my apps inside Intune for example :\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/14/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn.png\" height=\"836\" width=\"1603\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    So I have in total 13 win32 apps ready to be deployed , or uninstalled with the command lines needed to work ready and tested. I also have the ability to auto-update the apps for my Intune Managed Endpoints whenever a new version of the app is available and the service deploys it . How much time did that take ? Almost as much as I needed to package , test, and deploy 1 of them ! About 20 minutes from account creation to deployment !&nbsp;\n  </p>\n\n  <p>\n    And if you ever have a problem , such as app not deploying to your tenant , or app deployed and assigned but not getting installed on your endpoints just talk to support through the online chat at&nbsp;<a href=\"https://intunepckgr.com/\">https://intunepckgr.com/</a>&nbsp;. I am sure you will get a response within minutes with a solution to the problem . These guys are lightning fast!\n  </p>\n\n  <p>\n    This is really a game changer ! Kudos @intunepckgr and especially&nbsp;Dale Flanagan (linkedin :&nbsp;<a href=\"https://www.linkedin.com/in/daleflanagan/\">https://www.linkedin.com/in/daleflanagan/</a>&nbsp;who is the man responsible behind the project!\n  </p>",
            "image": "https://drontoso.gr/media/posts/14/IntunePCKGR.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "Microsoft Intune"
            ],
            "date_published": "2022-10-31T13:05:40+02:00",
            "date_modified": "2023-05-05T13:14:25+03:00"
        },
        {
            "id": "https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/",
            "url": "https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/",
            "title": "How can I install Microsoft 365 Apps via Intune from local source.",
            "summary": "Did you know you can initiate Microsoft 365 Apps via Intune when the source files are in your file server? Nor did I.&nbsp; Usecase : Customer needs to be able to push Microsoft 365 Apps via intune but network bandwidth is a huge stopper when&hellip;",
            "content_html": "\n  <p>\n    Did you know you can initiate Microsoft 365 Apps via Intune when the source files are in your file server? Nor did I.&nbsp;\n  </p>\n\n  <p>\n    Usecase : Customer needs to be able to push Microsoft 365 Apps via intune but network bandwidth is a huge stopper when multiple (thousands) Windows Devices try to reach Office CDN and download the required setup files.&nbsp;\n  </p>\n\n  <p>\n    So you allow all Intune Management Urls in order to manage endpoints via Intune but do not want to allow Office CDN Urls access to control bandwidth within the organization .&nbsp;\n  </p>\n\n  <p>\n    Well there is a way to do that.&nbsp;\n  </p>\n\n  <p>\n    There is only 1 Requirement . Your file server or any server which will download the required setup files needs to have proper Internet access only once. When the server downloads the setup files. Internet Access can be prohibited afterwards.&nbsp;\n  </p>\n\n  <p>\n    So go ahead and download Office Deployment tool :&nbsp;<a href=\"https://learn.microsoft.com/en-us/deployoffice/overview-office-deployment-tool\" class=\"\" target=\"_blank\">https://learn.microsoft.com/en-us/deployoffice/overview-office-deployment-tool</a>\n  </p>\n\n  <p>\n    Next go to Office Customization Tool :&nbsp;<a href=\"https://config.office.com/deploymentsettings\" class=\"\" target=\"_blank\">https://config.office.com/deploymentsettings</a>\n  </p>\n\n  <p>\n    Choose which apps you need to be installed on the Windows Clients (managed by Intune) and of course the rest of the settings like languages&nbsp; ,activation etc.&nbsp;\n  </p>\n\n  <p>\n    Do not forget to add the local source the office files will reside on for example:&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/13/IntuneOfficeInstallationViaLocalSource.png\" height=\"289\" width=\"857\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    Export the configuration xml let's say it's called configuration.xml.\n  </p>\n\n  <p>\n    Now login to the server which will host the setup files .&nbsp;\n  </p>\n\n  <p>\n    Move configuration.xml and Office Deployment tool to the server. Create a shared folder with proper permissions so your windows devices can reach and read the setup files.&nbsp;\n  </p>\n\n  <p>\n    Run setup.exe with the configuration.xml and the download switch for example :&nbsp;\n  </p>\n\n  <p>\n    setup.exe /download configuration.xml\n  </p>\n\n  <p>\n    Wait for the download process to complete . While waiting copy the content of configuration.xml to notepad .&nbsp;\n  </p>\n\n  <p>\n    Go ahead and create a new app within intune of type Microsoft 365 Apps :\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/13/Microsoft365-Apps.png\" height=\"250\" width=\"568\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    At the configure app suite step choose Enter XML Data&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/13/ConfigurationDesignerXML.png\" height=\"662\" width=\"843\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    Paste the configuration.xml data you have from notepad inside the XML Data and validate the XML . When XML is validated go ahead and assign the&nbsp; app .&nbsp;\n  </p>\n\n  <p>\n    Done!\n  </p>",
            "image": "https://drontoso.gr/media/posts/13/MicrosoftIntuneM365AppsLocalSource.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "Microsoft Intune",
                   "M365 Apps"
            ],
            "date_published": "2022-10-25T15:10:56+03:00",
            "date_modified": "2023-05-05T13:15:35+03:00"
        },
        {
            "id": "https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/",
            "url": "https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/",
            "title": "Exchange Public Folders Migration - SourceSideValidation script shows OrphanedMPF folders.",
            "summary": "So you are trying to run SourceSideVaildation.ps1 script provided from MS&nbsp;and find out OrphanedMPF objects that the script indicates that need to be cleaned up . The output of the script shows something like this :&nbsp; As granikos explains in more detail : https://granikos.eu/exchange-public-folder-meso-object-not-deleted/ So&hellip;",
            "content_html": "\n  <p>\n    So you are trying to run SourceSideVaildation.ps1 script provided from <a href=\"https://techcommunity.microsoft.com/t5/exchange-team-blog/making-your-public-folder-migrations-faster-and-more-reliable/ba-p/917622\" target=\"_blank\">MS</a>&nbsp;and find out OrphanedMPF objects that the script indicates that need to be cleaned up . The output of the script shows something like this :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/12/OrphanedMPFs.png\" height=\"36\" width=\"744\" alt=\"OrphanedMPFs\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-xs.png 300w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-sm.png 480w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-md.png 768w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-lg.png 1024w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-xl.png 1360w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    As granikos explains in more detail : <a href=\"https://As granikos explains in more detail : https://granikos.eu/exchange-public-folder-meso-object-not-deleted/\">https://granikos.eu/exchange-public-folder-meso-object-not-deleted/</a>\n  </p>\n\n  <p>\n    So the next thing to do is to find the orphaned entries and delete them .&nbsp;\n  </p>\n\n  <p>\n    So after searching ADSI in the appropriate path I found 2 entries as expected :&nbsp;\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://drontoso.gr/media/posts/12/PublicFoldersADSI.png\" height=\"448\" width=\"1027\" alt=\"\"  sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-xs.png 300w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-sm.png 480w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-md.png 768w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-lg.png 1024w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-xl.png 1360w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-2xl.png 1600w\">\n      \n    </figure>\n\n  <p>\n    <br>\n  </p>\n\n  <p>\n    The right one to delete is the one without random numbers after it's name but to be sure check the when created date. As you noticed the one with the random numbers was indeed created after the one without numbers. This confirms that the one without random numbers is the right one that needs to be deleted.&nbsp;\n  </p>\n\n  <p>\n    In my case after re-running the script the folder with the number re-appeared in suggestions . This confirms that the folder is no longer mail-enabled and the entries have to be deleted (both) . But to be sure check if the public folder is mail-enabled before deleting both entries.\n  </p>\n\n  <p>\n    \n  </p>\n\n  <p>\n    \n  </p>",
            "image": "https://drontoso.gr/media/posts/12/microsoft-exchange-logo_resized.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "PublicFolders Migration",
                   "Exchange"
            ],
            "date_published": "2022-10-25T11:38:45+03:00",
            "date_modified": "2023-05-05T13:16:11+03:00"
        },
        {
            "id": "https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/",
            "url": "https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/",
            "title": "Manage Exhange Online Mailbox Quotas based on group membership through Powershell",
            "summary": "If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to&hellip;",
            "content_html": "<p>If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to sales department . </p>\n<p>For that reason I created the Powershell script below . </p>\n<p>Feel free to change / share / comment .</p>\n<p>Script contains parts of the script originally posted by </p>\n<div>Johan Dahlbom from 365lab.net so credits to Johan :D </div>\n<div> </div>\n<p>Script Logic : </p>\n<ul>\n<li>Checks if the script was run under admin privileges otherwise informs the user to rerun with admin privs.</li>\n<li>Checks if MSOnline and Exchange Online Modules are installed . </li>\n<li>If they are not it tries to install them . </li>\n<li>Checks if there are active MSOnline and Exchange Online Sessions. If there are not it prompts you to enter credentials to connect .</li>\n<li>Asks the user to provide the name of the group which will get the following quota policy (of course you can change the values to suit your needs) : \n<div>ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</div>\n<div>Asks  the user to provide the script output folder (usefull when you run it against multiple users) . </div>\n</li>\n<li>Then it changes all group's members quota to the one mentioned above</li>\n<li>And also changes all other users quotas to \n<div>ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</div>\n</li>\n</ul>\n<p>The Script : </p>\n<div>\n<div>\n<div> </div>\n</div>\n</div>\n<div>\n<div>\n<div><code>function EditMailboxQuotas {</code></div>\n<div><code>    $OutPutFolder = \"c:\\temp\\EditMailboxQuotas.txt\"</code></div>\n<div><code>    $SpecificUserQuota=$null</code></div>\n<div><code>    $ConvertedQuotaToKB = $null</code></div>\n<div><code>    Write-Host \"Please input the name of the group members of which will be assigned 5GB Quota\"</code></div>\n<div><code>        $ADGroup = Read-Host -Prompt 'Input the group name'</code></div>\n<div><code>        Write-Host \"Input the folder to export all script output - Please include file name as well\" -ForegroundColor Green</code></div>\n<div><code>        $OutPutFolder = Read-Host -Prompt 'Folder path and file name to export output to \"Example:c:\\filename.txt\"'</code></div>\n<div><code>       </code></div>\n<div><code>        Write-Host \"Searching for Group \" $ADGroup</code></div>\n<div><code>        Write-Output \"Searching for Group \" $ADGroup | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Import-Module AzureAD</code></div>\n<div><code>        Import-Module MSOnline</code></div>\n<div><code>        Import-Module ExchangeOnlineManagement</code></div>\n<div><code>        #Connect-MsolService</code></div>\n<div><code>        $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div>\n<div><code>            if (-not($MSOLAccountSku)) {</code></div>\n<div><code>                Connect-MsolService</code></div>\n<div><code>            }</code></div>\n<div><code>        $getsessions = Get-PSSession | Select-Object -Property State, Name</code></div>\n<div><code>        #Connect-ExchangeOnline</code></div>\n<div><code>        $IsconnectedToEOL = (@($getsessions) -like '@{State=Opened; Name=ExchangeOnlineInternalSession*').Count -gt 0</code></div>\n<div><code>            If ($IsconnectedToEOL -ne \"True\") {</code></div>\n<div><code>            Connect-ExchangeOnline</code></div>\n<div><code>            }  </code></div>\n<div><code>        #Connect-ExchangeOnline</code></div>\n<div><code>        $MSOLGroup = Get-MsolGroup -SearchString $ADGroup</code></div>\n<div><code>        Write-Host \"Group's id is  \" $MSOLGroup.ObjectId</code></div>\n<div><code>        Write-Output \"Group's id is  \" $MSOLGroup.ObjectId | Out-File $OutPutFolder -Append</code></div>\n<div><code>        write-host \"------------- Configuring quotas for all users who are members of the group  \" $ADGroup \"-------------\" -ForegroundColor Magenta</code></div>\n<div><code>        Write-Output \"------------- Configuring quotas for all users who are members of the group  \" $ADGroup \"-------------\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Read-Host -Prompt \"Press any key to continue configuring quotas for all users who are members of the group to 5GB or CTRL+C to quit\"</code></div>\n<div><code>        Start-Sleep -Seconds 3</code></div>\n<div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)</code></div>\n<div><code>        if($null -ne $UsersWithinGroup)</code></div>\n<div><code>            {#Check if mailbox quota more than 5gb</code></div>\n<div><code>            foreach ($UserWithinGroup in $UsersWithinGroup)</code></div>\n<div><code>             {     $UserWithinGroup.EmailAddress</code></div>\n<div><code>                   $SpecificUserQuota = Get-Mailbox $UserWithinGroup.EmailAddress | Select-Object ProhibitSendReceiveQuota</code></div>\n<div><code>           </code></div>\n<div><code>                   $ConvertedQuotaToKB = Convert-QuotaStringToKB($SpecificUserQuota)</code></div>\n<div><code>             If($ConvertedQuotaToKB -gt 5242880 ) {#quota is more than 5gb</code></div>\n<div><code>                Write-Host \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota more than 5gb will check mailbox size\" -ForegroundColor Cyan</code></div>\n<div><code>                Write-Output \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota more than 5gb will check mailbox size\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                ##Check if mailbox size is more than 4.5</code></div>\n<div><code>                $MailboxSize =  Get-MailboxStatistics $UserWithinGroup.EmailAddress | Select-Object TotalItemSize</code></div>\n<div><code>                $MailboxSizeInKB = Convert-QuotaStringToKB($MailboxSize)</code></div>\n<div><code>                    if ($MailboxSizeInKB -gt 4718592){#If user mailbox size is more than 4.5 GB</code></div>\n<div><code>                        Write-Host \"Mailbox size is more than 4.5 GB No changes will be made \" -ForegroundColor Red</code></div>\n<div><code>                        Write-Output \"Mailbox size is more than 4.5 GB No changes will be made \" -Append</code></div>\n<div><code>                        #do Nothing</code></div>\n<div><code>                            }    #If user mailbox size is more than 4.5 GB</code></div>\n<div><code>                        if ($MailboxSizeInKB -lt 4718592) {#Mailbox size is less than 4.5 GB</code></div>\n<div><code>                        Write-Host \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $MailboxSizeInKB \"KB mailbox size mailbox quota will be changed\" -ForegroundColor Green</code></div>\n<div><code>                        Write-Output \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $MailboxSizeInKB \"KB mailbox size mailbox quota will be changed\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>\n<div><code>                           </code></div>\n<div><code>                        $SpecificUserQuota = $null</code></div>\n<div><code>                            }   #Mailbox size is less than 4.5 GB</code></div>\n<div><code>                        }              </code></div>\n<div><code>                        elseif ($ConvertedQuotaToKB -eq 5242880 ) { #quota is 5gb</code></div>\n<div><code>                            ##Do nothing</code></div>\n<div><code>                         Write-Host \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota 5gb Nothing will be changed\"  -ForegroundColor Red</code></div>\n<div><code>                         Write-Output \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota 5gb Nothing will be changed\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                         $SpecificUserQuota = $null</code></div>\n<div><code>                        }</code></div>\n<div><code>                   </code></div>\n<div><code>                        elseIf ($UserWithinGroup.UseDatabaseQuotaDefaults) #quota used from db defaults</code></div>\n<div><code>                        {   Write-Host \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"uses defaults changing\"  -ForegroundColor Red</code></div>\n<div><code>                        Write-Output \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"uses defaults changing\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                       </code></div>\n<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>\n<div><code>                        }</code></div>\n<div><code>                        elseif ($ConvertedQuotaToKB -lt 5242880) #quota is less than 5gb and not db defaults</code></div>\n<div><code>                        {   Write-Host \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota less than 5gb Quotas will be changed\"  -ForegroundColor Green</code></div>\n<div><code>                        Write-Output \"CurrentUser\" $UserWithinGroup.EmailAddress \"has\" $ConvertedQuotaToKB \"KB Quota less than 5gb Quotas will be changed\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>\n<div><code>                        }</code></div>\n<div><code>           </code></div>\n<div><code>        }#ForEach</code></div>\n<div><code>    }#If</code></div>\n<br>\n<div><code>        else {</code></div>\n<div><code>            #GroupIsEmpty</code></div>\n<div><code>        }</code></div>\n<br>\n<div><code>       </code></div>\n<div><code>        write-host \"------------- Configuring quotas for all users EXCLUDING those who are members of the group \" $ADGroup \"-------------\" -ForegroundColor Magenta</code></div>\n<div><code>        Write-Output write-host \"------------- Configuring quotas for all users EXCLUDING those who are members of the group \" $ADGroup \"-------------\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Read-Host -Prompt \"Press any key to continue configuring quotas for ALL usersof the organization who are not members of the group to 80GB or CTRL+C to quit\"</code></div>\n<div><code>        Start-Sleep -Seconds 3</code></div>\n<div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)  </code></div>\n<div><code>        $EXOMailboxes = Get-EXOMailbox -RecipientTypeDetails UserMailbox</code></div>\n<div><code>    foreach($EXOMailbox in $EXOMailboxes)</code></div>\n<div><code>        {write-host \"For mailbox  \"$EXOMailbox.primarySMtpaddress -ForegroundColor White</code></div>\n<div><code>        Write-Output \"For mailbox  \"$EXOMailbox.primarySMtpaddress | Out-File $OutPutFolder -Append</code></div>\n<div><code>            if(!(Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress}))</code></div>\n<div><code>                {write-host \"Configuring Quota For mailbox  \"$EXOMailbox.primarySMtpaddress \" to 80GB\" -ForegroundColor Green</code></div>\n<div><code>                Write-Output \"Configuring Quota For mailbox  \"$EXOMailbox.primarySMtpaddress \" to 80GB\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>                set-Mailbox $EXOMailbox.primarySMtpaddress -ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</code></div>\n<div><code>                     </code></div>\n<div><code>                }#if</code></div>\n<div><code>                elseif (Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress})</code></div>\n<div><code>                {  </code></div>\n<div><code>                    write-host \"For mailbox  \"$EXOMailbox.primarySMtpaddress \"Nothing will be changed because user is a member of the group\" $ADGroup -ForegroundColor red  </code></div>\n<div><code>                    Write-Output \"For mailbox  \"$EXOMailbox.primarySMtpaddress \"Nothing will be changed because user is a member of the group\" $ADGroup | Out-File $OutPutFolder -Append</code></div>\n<div><code>                }</code></div>\n<div><code>               </code></div>\n<div><code>        }#ForEachEXOMailbox</code></div>\n<div><code>        Write-Host \"All quotas configuration is finished . If you need to change quotas again re-run the script.\"  -ForegroundColor Gray</code></div>\n<div><code>        Write-Output  \"All quotas configuration is finished . If you need to change quotas again re-run the script.\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>}#FunctionEditMailboxQuotas  </code></div>\n<div><code>Function Convert-QuotaStringToKB() {</code></div>\n<br>\n<div><code>    Param([string]$CurrentQuota)</code></div>\n<br>\n<div><code>    [string]$CurrentQuota = ($CurrentQuota.Split(\"(\"))[1]</code></div>\n<div><code>    [string]$CurrentQuota = ($CurrentQuota.Split(\" bytes)\"))[0]</code></div>\n<div><code>    $CurrentQuota = $CurrentQuota.Replace(\",\",\"\")</code></div>\n<div><code>    [int]$CurrentQuotaInKB = \"{0:F0}\" -f ($CurrentQuota/1024)</code></div>\n<br>\n<div><code>    return $CurrentQuotaInKB</code></div>\n<div><code>}</code></div>\n<br>\n<div><code>Function Get-JDMsolGroupMember {</code></div>\n<div> </div>\n<div><code>       </code></div>\n<div><code>        param(</code></div>\n<div><code>            [CmdletBinding(SupportsShouldProcess=$true)]</code></div>\n<div><code>            [Parameter(Mandatory=$true, ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true,Position=0)]</code></div>\n<div><code>            [ValidateScript({Get-MsolGroup -ObjectId $_})]</code></div>\n<div><code>            $ObjectId,</code></div>\n<div><code>            [switch]$Recursive</code></div>\n<div><code>        )</code></div>\n<div><code>        begin {</code></div>\n<div><code>            $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div>\n<div><code>            if (-not($MSOLAccountSku)) {</code></div>\n<div><code>                throw \"Not connected to Azure AD, run Connect-MsolService\"</code></div>\n<div><code>            }</code></div>\n<div><code>        }</code></div>\n<div><code>        process {</code></div>\n<div><code>            Write-Verbose -Message \"Enumerating group members in group $ObjectId\"</code></div>\n<div><code>            [array]$UserMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes User -All</code></div>\n<div><code>            if ($PSBoundParameters['Recursive']) {</code></div>\n<div><code>                $GroupsMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes Group -All</code></div>\n<div><code>                if ($GroupsMembers) {</code></div>\n<div><code>                    Write-Verbose -Message \"$ObjectId have $($GroupsMembers.count) group(s) as members, enumerating...\"</code></div>\n<div><code>                    $GroupsMembers | ForEach-Object -Process {</code></div>\n<div><code>                        Write-Verbose \"Enumerating nested group $($_.Displayname) ($($_.ObjectId))\"</code></div>\n<div><code>                        $UserMembers += Get-JDMsolGroupMember -Recursive -ObjectId $_.ObjectId</code></div>\n<div><code>                    }</code></div>\n<div><code>                }</code></div>\n<div><code>            }</code></div>\n<div><code>            Write-Output ($UserMembers | Sort-Object -Property EmailAddress -Unique)</code></div>\n<div><code>               </code></div>\n<div><code>        }</code></div>\n<div><code>        end {</code></div>\n<div><code>           </code></div>\n<div><code>        }</code></div>\n<div><code>    }</code></div>\n<br><br>\n<div><code>if (Get-Module -Name ExchangeOnlineManagement) {</code></div>\n<div><code>    Write-Host \"Exchange online Module installed proceeding to next steps\"</code></div>\n<div><code>    #Write-Output  \"Exchange online Module installed proceeding to next steps\"| Out-File $OutPutFolder -Append</code></div>\n<div><code>    Start-Sleep -Seconds 2</code></div>\n<div><code>}</code></div>\n<div><code>else {</code></div>\n<div><code>    Write-Host \"Exchange online Module does not exist needs to be installed to proceed \"</code></div>\n<div><code>    #Write-Output  \"Exchange online Module does not exist needs to be installed to proceed \" | Out-File $OutPutFolder -Append</code></div>\n<div><code>    Start-Sleep -Seconds 2</code></div>\n<div><code>    $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div>\n<div><code>    if ($isadmin)</code></div>\n<div><code>    {   Write-Host \"Installing Exchange online Module .... \"</code></div>\n<div><code>    #Write-Output \"Installing Exchange online Module .... \" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Install-module ExchangeOnlineManagement -Force        </code></div>\n<div><code>    }</code></div>\n<div><code>    else {</code></div>\n<div><code>        Write-Host \"It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed\"</code></div>\n<div><code>       # Write-Output \"It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Pause</code></div>\n<div><code>    }</code></div>\n<div><code>}</code></div>\n<div><code>if (Get-Module -Name MSOnline) {</code></div>\n<div><code>        Write-Host \"MSOnline online Module installed proceeding to next steps\"</code></div>\n<div><code>       # Write-Output \"MSOnline online Module installed proceeding to next steps\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        Start-Sleep -Seconds 2</code></div>\n<div><code>    }</code></div>\n<div><code>else {</code></div>\n<div><code>        Write-Host \"MSOnline does not exist needs to be installed to proceed \"</code></div>\n<div><code>       # Write-Output \"MSOnline does not exist needs to be installed to proceed \" | Out-File $OutPutFolder -Append</code></div>\n<div><code>        $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div>\n<div><code>        if ($isadmin)</code></div>\n<div><code>        {</code></div>\n<div><code>            Install-module MSOnline -Force</code></div>\n<div><code>        }</code></div>\n<div><code>        else {</code></div>\n<div><code>            Write-Host \"It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed\"</code></div>\n<div><code>        #    Write-Output \"It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed\" | Out-File $OutPutFolder -Append</code></div>\n<div><code>            Pause</code></div>\n<div><code>        }</code></div>\n<br>\n<div><code>   </code></div>\n<div><code>    }</code></div>\n<div><code>    EditMailboxQuotas</code></div>\n<div> </div>\n<div>\n<div>\n<div><strong>The script is provided “AS IS” with no guarantees, no warranties, and it confer no rights.</strong></div>\n<div> </div>\n</div>\n</div>\n</div>\n</div>\n<p> </p>",
            "image": "https://drontoso.gr/media/posts/11/mailboxquotas.png",
            "author": {
                "name": "Ilias Drosos"
            },
            "tags": [
                   "PowerShellScripts",
                   "Exchange"
            ],
            "date_published": "2022-07-13T16:35:12+03:00",
            "date_modified": "2023-05-05T13:16:29+03:00"
        }
    ]
}
