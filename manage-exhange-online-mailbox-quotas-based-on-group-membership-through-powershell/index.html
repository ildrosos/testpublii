<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Manage Exhange Online Mailbox Quotas based on group membership through Powershell - Drontoso</title><meta name="description" content="If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/"><link rel="amphtml" href="https://drontoso.gr/amp/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/"><link rel="alternate" type="application/atom+xml" href="https://drontoso.gr/feed.xml"><link rel="alternate" type="application/json" href="https://drontoso.gr/feed.json"><meta property="og:title" content="Manage Exhange Online Mailbox Quotas based on group membership through Powershell"><meta property="og:image" content="https://drontoso.gr/media/posts/11/mailboxquotas.png"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="408"><meta property="og:site_name" content="Drontoso"><meta property="og:description" content="If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to&hellip;"><meta property="og:url" content="https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://drontoso.gr/media/website/favicon-16x16.png" type="image/png"><link rel="stylesheet" href="https://drontoso.gr/assets/css/style.css?v=dfc2b7bc369d646ef98d75a857083e05"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/"},"headline":"Manage Exhange Online Mailbox Quotas based on group membership through Powershell","datePublished":"2022-07-13T16:35","dateModified":"2023-05-05T13:16","image":{"@type":"ImageObject","url":"https://drontoso.gr/media/posts/11/mailboxquotas.png","height":408,"width":1024},"description":"If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to&hellip;","author":{"@type":"Person","name":"Ilias Drosos","url":"https://drontoso.gr/authors/acc/"},"publisher":{"@type":"Organization","name":"Ilias Drosos","logo":{"@type":"ImageObject","url":"https://drontoso.gr/media/website/dRONTOSO-LOGO-BLUE.jpg","height":200,"width":670}}}</script></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://drontoso.gr/"><img src="https://drontoso.gr/media/website/dRONTOSO-LOGO-BLUE.jpg" alt="Drontoso"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://drontoso.gr/" target="_self">Home</a></li><li class="has-submenu"><a href="https://drontoso.gr/tags/exchange/" title="Microsoft Exchange" target="_self" aria-haspopup="true">Microsoft Exchange</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://drontoso.gr/tags/hybrid-configuration-wizard/" title="Hybrid Configuration Wizard" target="_self">Hybrid Configuration Wizard</a></li><li><a href="https://drontoso.gr/tags/adconnect/" title="ADConnect" target="_self">ADConnect</a></li></ul></li><li><a href="https://drontoso.gr/tags/microsoft-intune/" title="Microsoft Intune" target="_self">Microsoft Intune</a></li><li><a href="https://drontoso.gr/tags/m365-apps/" title="M365 Apps" target="_self">M365 Apps</a></li><li><a href="https://drontoso.gr/tags/codetwooffice365migration/" title="CodeTwoOffice365Migration" target="_self">CodeTwo</a></li><li><a href="https://drontoso.gr/authors/acc/" target="_self">Author</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2023-05-05T13:27">May 5, 2023</time></div><div class="infobar__search"><form action="https://drontoso.gr/search.html"><input type="search" name="q" placeholder="search..." aria-label="Search input"> <button type="submit" aria-label="Submit"><svg role="presentation" focusable="false" width="15px" height="14px"><use xlink:href="https://drontoso.gr/assets/svg/svg-map.svg#search"/></svg></button></form></div></div><main class="main"><article class="post"><figure class="post__featured-image"><img src="https://drontoso.gr/media/posts/11/mailboxquotas.png" srcset="https://drontoso.gr/media/posts/11/responsive/mailboxquotas-xs.png 300w, https://drontoso.gr/media/posts/11/responsive/mailboxquotas-sm.png 480w, https://drontoso.gr/media/posts/11/responsive/mailboxquotas-md.png 768w, https://drontoso.gr/media/posts/11/responsive/mailboxquotas-lg.png 1024w, https://drontoso.gr/media/posts/11/responsive/mailboxquotas-xl.png 1360w, https://drontoso.gr/media/posts/11/responsive/mailboxquotas-2xl.png 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="408" width="1024" alt=""></figure><header class="u-header post__header"><h1>Manage Exhange Online Mailbox Quotas based on group membership through Powershell</h1><div class="u-header__meta u-small"><img src="https://drontoso.gr/media/website/idrosos.jpg" loading="eager" class="u-header__avatar" alt="Ilias Drosos" height="450" width="450"><div><a href="https://drontoso.gr/authors/acc/" title="Ilias Drosos">Ilias Drosos</a> <time datetime="2022-07-13T16:35">July 13, 2022 </time><a href="https://drontoso.gr/tags/exchange/" class="u-tag u-tag--1">Exchange</a></div></div></header><div class="post__entry u-inner"><p>If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to sales department . </p><p>For that reason I created the Powershell script below . </p><p>Feel free to change / share / comment .</p><p>Script contains parts of the script originally posted by </p><div>Johan Dahlbom from 365lab.net so credits to Johan :D </div><div> </div><p>Script Logic : </p><ul><li>Checks if the script was run under admin privileges otherwise informs the user to rerun with admin privs.</li><li>Checks if MSOnline and Exchange Online Modules are installed . </li><li>If they are not it tries to install them . </li><li>Checks if there are active MSOnline and Exchange Online Sessions. If there are not it prompts you to enter credentials to connect .</li><li>Asks the user to provide the name of the group which will get the following quota policy (of course you can change the values to suit your needs) : <div>ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</div><div>Asks  the user to provide the script output folder (usefull when you run it against multiple users) . </div></li><li>Then it changes all group's members quota to the one mentioned above</li><li>And also changes all other users quotas to <div>ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</div></li></ul><p>The Script : </p><div><div><div> </div></div></div><div><div><div><code>function EditMailboxQuotas {</code></div><div><code>    $OutPutFolder = "c:\temp\EditMailboxQuotas.txt"</code></div><div><code>    $SpecificUserQuota=$null</code></div><div><code>    $ConvertedQuotaToKB = $null</code></div><div><code>    Write-Host "Please input the name of the group members of which will be assigned 5GB Quota"</code></div><div><code>        $ADGroup = Read-Host -Prompt 'Input the group name'</code></div><div><code>        Write-Host "Input the folder to export all script output - Please include file name as well" -ForegroundColor Green</code></div><div><code>        $OutPutFolder = Read-Host -Prompt 'Folder path and file name to export output to "Example:c:\filename.txt"'</code></div><div><code>       </code></div><div><code>        Write-Host "Searching for Group " $ADGroup</code></div><div><code>        Write-Output "Searching for Group " $ADGroup | Out-File $OutPutFolder -Append</code></div><div><code>        Import-Module AzureAD</code></div><div><code>        Import-Module MSOnline</code></div><div><code>        Import-Module ExchangeOnlineManagement</code></div><div><code>        #Connect-MsolService</code></div><div><code>        $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div><div><code>            if (-not($MSOLAccountSku)) {</code></div><div><code>                Connect-MsolService</code></div><div><code>            }</code></div><div><code>        $getsessions = Get-PSSession | Select-Object -Property State, Name</code></div><div><code>        #Connect-ExchangeOnline</code></div><div><code>        $IsconnectedToEOL = (@($getsessions) -like '@{State=Opened; Name=ExchangeOnlineInternalSession*').Count -gt 0</code></div><div><code>            If ($IsconnectedToEOL -ne "True") {</code></div><div><code>            Connect-ExchangeOnline</code></div><div><code>            }  </code></div><div><code>        #Connect-ExchangeOnline</code></div><div><code>        $MSOLGroup = Get-MsolGroup -SearchString $ADGroup</code></div><div><code>        Write-Host "Group's id is  " $MSOLGroup.ObjectId</code></div><div><code>        Write-Output "Group's id is  " $MSOLGroup.ObjectId | Out-File $OutPutFolder -Append</code></div><div><code>        write-host "------------- Configuring quotas for all users who are members of the group  " $ADGroup "-------------" -ForegroundColor Magenta</code></div><div><code>        Write-Output "------------- Configuring quotas for all users who are members of the group  " $ADGroup "-------------" | Out-File $OutPutFolder -Append</code></div><div><code>        Read-Host -Prompt "Press any key to continue configuring quotas for all users who are members of the group to 5GB or CTRL+C to quit"</code></div><div><code>        Start-Sleep -Seconds 3</code></div><div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)</code></div><div><code>        if($null -ne $UsersWithinGroup)</code></div><div><code>            {#Check if mailbox quota more than 5gb</code></div><div><code>            foreach ($UserWithinGroup in $UsersWithinGroup)</code></div><div><code>             {     $UserWithinGroup.EmailAddress</code></div><div><code>                   $SpecificUserQuota = Get-Mailbox $UserWithinGroup.EmailAddress | Select-Object ProhibitSendReceiveQuota</code></div><div><code>           </code></div><div><code>                   $ConvertedQuotaToKB = Convert-QuotaStringToKB($SpecificUserQuota)</code></div><div><code>             If($ConvertedQuotaToKB -gt 5242880 ) {#quota is more than 5gb</code></div><div><code>                Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota more than 5gb will check mailbox size" -ForegroundColor Cyan</code></div><div><code>                Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota more than 5gb will check mailbox size" | Out-File $OutPutFolder -Append</code></div><div><code>                ##Check if mailbox size is more than 4.5</code></div><div><code>                $MailboxSize =  Get-MailboxStatistics $UserWithinGroup.EmailAddress | Select-Object TotalItemSize</code></div><div><code>                $MailboxSizeInKB = Convert-QuotaStringToKB($MailboxSize)</code></div><div><code>                    if ($MailboxSizeInKB -gt 4718592){#If user mailbox size is more than 4.5 GB</code></div><div><code>                        Write-Host "Mailbox size is more than 4.5 GB No changes will be made " -ForegroundColor Red</code></div><div><code>                        Write-Output "Mailbox size is more than 4.5 GB No changes will be made " -Append</code></div><div><code>                        #do Nothing</code></div><div><code>                            }    #If user mailbox size is more than 4.5 GB</code></div><div><code>                        if ($MailboxSizeInKB -lt 4718592) {#Mailbox size is less than 4.5 GB</code></div><div><code>                        Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $MailboxSizeInKB "KB mailbox size mailbox quota will be changed" -ForegroundColor Green</code></div><div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $MailboxSizeInKB "KB mailbox size mailbox quota will be changed" | Out-File $OutPutFolder -Append</code></div><div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div><div><code>                           </code></div><div><code>                        $SpecificUserQuota = $null</code></div><div><code>                            }   #Mailbox size is less than 4.5 GB</code></div><div><code>                        }              </code></div><div><code>                        elseif ($ConvertedQuotaToKB -eq 5242880 ) { #quota is 5gb</code></div><div><code>                            ##Do nothing</code></div><div><code>                         Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota 5gb Nothing will be changed"  -ForegroundColor Red</code></div><div><code>                         Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota 5gb Nothing will be changed" | Out-File $OutPutFolder -Append</code></div><div><code>                         $SpecificUserQuota = $null</code></div><div><code>                        }</code></div><div><code>                   </code></div><div><code>                        elseIf ($UserWithinGroup.UseDatabaseQuotaDefaults) #quota used from db defaults</code></div><div><code>                        {   Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "uses defaults changing"  -ForegroundColor Red</code></div><div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "uses defaults changing" | Out-File $OutPutFolder -Append</code></div><div><code>                       </code></div><div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div><div><code>                        }</code></div><div><code>                        elseif ($ConvertedQuotaToKB -lt 5242880) #quota is less than 5gb and not db defaults</code></div><div><code>                        {   Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota less than 5gb Quotas will be changed"  -ForegroundColor Green</code></div><div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota less than 5gb Quotas will be changed" | Out-File $OutPutFolder -Append</code></div><div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div><div><code>                        }</code></div><div><code>           </code></div><div><code>        }#ForEach</code></div><div><code>    }#If</code></div><br><div><code>        else {</code></div><div><code>            #GroupIsEmpty</code></div><div><code>        }</code></div><br><div><code>       </code></div><div><code>        write-host "------------- Configuring quotas for all users EXCLUDING those who are members of the group " $ADGroup "-------------" -ForegroundColor Magenta</code></div><div><code>        Write-Output write-host "------------- Configuring quotas for all users EXCLUDING those who are members of the group " $ADGroup "-------------" | Out-File $OutPutFolder -Append</code></div><div><code>        Read-Host -Prompt "Press any key to continue configuring quotas for ALL usersof the organization who are not members of the group to 80GB or CTRL+C to quit"</code></div><div><code>        Start-Sleep -Seconds 3</code></div><div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)  </code></div><div><code>        $EXOMailboxes = Get-EXOMailbox -RecipientTypeDetails UserMailbox</code></div><div><code>    foreach($EXOMailbox in $EXOMailboxes)</code></div><div><code>        {write-host "For mailbox  "$EXOMailbox.primarySMtpaddress -ForegroundColor White</code></div><div><code>        Write-Output "For mailbox  "$EXOMailbox.primarySMtpaddress | Out-File $OutPutFolder -Append</code></div><div><code>            if(!(Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress}))</code></div><div><code>                {write-host "Configuring Quota For mailbox  "$EXOMailbox.primarySMtpaddress " to 80GB" -ForegroundColor Green</code></div><div><code>                Write-Output "Configuring Quota For mailbox  "$EXOMailbox.primarySMtpaddress " to 80GB" | Out-File $OutPutFolder -Append</code></div><div><code>                set-Mailbox $EXOMailbox.primarySMtpaddress -ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</code></div><div><code>                     </code></div><div><code>                }#if</code></div><div><code>                elseif (Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress})</code></div><div><code>                {  </code></div><div><code>                    write-host "For mailbox  "$EXOMailbox.primarySMtpaddress "Nothing will be changed because user is a member of the group" $ADGroup -ForegroundColor red  </code></div><div><code>                    Write-Output "For mailbox  "$EXOMailbox.primarySMtpaddress "Nothing will be changed because user is a member of the group" $ADGroup | Out-File $OutPutFolder -Append</code></div><div><code>                }</code></div><div><code>               </code></div><div><code>        }#ForEachEXOMailbox</code></div><div><code>        Write-Host "All quotas configuration is finished . If you need to change quotas again re-run the script."  -ForegroundColor Gray</code></div><div><code>        Write-Output  "All quotas configuration is finished . If you need to change quotas again re-run the script." | Out-File $OutPutFolder -Append</code></div><div><code>}#FunctionEditMailboxQuotas  </code></div><div><code>Function Convert-QuotaStringToKB() {</code></div><br><div><code>    Param([string]$CurrentQuota)</code></div><br><div><code>    [string]$CurrentQuota = ($CurrentQuota.Split("("))[1]</code></div><div><code>    [string]$CurrentQuota = ($CurrentQuota.Split(" bytes)"))[0]</code></div><div><code>    $CurrentQuota = $CurrentQuota.Replace(",","")</code></div><div><code>    [int]$CurrentQuotaInKB = "{0:F0}" -f ($CurrentQuota/1024)</code></div><br><div><code>    return $CurrentQuotaInKB</code></div><div><code>}</code></div><br><div><code>Function Get-JDMsolGroupMember {</code></div><div> </div><div><code>       </code></div><div><code>        param(</code></div><div><code>            [CmdletBinding(SupportsShouldProcess=$true)]</code></div><div><code>            [Parameter(Mandatory=$true, ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true,Position=0)]</code></div><div><code>            [ValidateScript({Get-MsolGroup -ObjectId $_})]</code></div><div><code>            $ObjectId,</code></div><div><code>            [switch]$Recursive</code></div><div><code>        )</code></div><div><code>        begin {</code></div><div><code>            $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div><div><code>            if (-not($MSOLAccountSku)) {</code></div><div><code>                throw "Not connected to Azure AD, run Connect-MsolService"</code></div><div><code>            }</code></div><div><code>        }</code></div><div><code>        process {</code></div><div><code>            Write-Verbose -Message "Enumerating group members in group $ObjectId"</code></div><div><code>            [array]$UserMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes User -All</code></div><div><code>            if ($PSBoundParameters['Recursive']) {</code></div><div><code>                $GroupsMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes Group -All</code></div><div><code>                if ($GroupsMembers) {</code></div><div><code>                    Write-Verbose -Message "$ObjectId have $($GroupsMembers.count) group(s) as members, enumerating..."</code></div><div><code>                    $GroupsMembers | ForEach-Object -Process {</code></div><div><code>                        Write-Verbose "Enumerating nested group $($_.Displayname) ($($_.ObjectId))"</code></div><div><code>                        $UserMembers += Get-JDMsolGroupMember -Recursive -ObjectId $_.ObjectId</code></div><div><code>                    }</code></div><div><code>                }</code></div><div><code>            }</code></div><div><code>            Write-Output ($UserMembers | Sort-Object -Property EmailAddress -Unique)</code></div><div><code>               </code></div><div><code>        }</code></div><div><code>        end {</code></div><div><code>           </code></div><div><code>        }</code></div><div><code>    }</code></div><br><br><div><code>if (Get-Module -Name ExchangeOnlineManagement) {</code></div><div><code>    Write-Host "Exchange online Module installed proceeding to next steps"</code></div><div><code>    #Write-Output  "Exchange online Module installed proceeding to next steps"| Out-File $OutPutFolder -Append</code></div><div><code>    Start-Sleep -Seconds 2</code></div><div><code>}</code></div><div><code>else {</code></div><div><code>    Write-Host "Exchange online Module does not exist needs to be installed to proceed "</code></div><div><code>    #Write-Output  "Exchange online Module does not exist needs to be installed to proceed " | Out-File $OutPutFolder -Append</code></div><div><code>    Start-Sleep -Seconds 2</code></div><div><code>    $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div><div><code>    if ($isadmin)</code></div><div><code>    {   Write-Host "Installing Exchange online Module .... "</code></div><div><code>    #Write-Output "Installing Exchange online Module .... " | Out-File $OutPutFolder -Append</code></div><div><code>        Install-module ExchangeOnlineManagement -Force        </code></div><div><code>    }</code></div><div><code>    else {</code></div><div><code>        Write-Host "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed"</code></div><div><code>       # Write-Output "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed" | Out-File $OutPutFolder -Append</code></div><div><code>        Pause</code></div><div><code>    }</code></div><div><code>}</code></div><div><code>if (Get-Module -Name MSOnline) {</code></div><div><code>        Write-Host "MSOnline online Module installed proceeding to next steps"</code></div><div><code>       # Write-Output "MSOnline online Module installed proceeding to next steps" | Out-File $OutPutFolder -Append</code></div><div><code>        Start-Sleep -Seconds 2</code></div><div><code>    }</code></div><div><code>else {</code></div><div><code>        Write-Host "MSOnline does not exist needs to be installed to proceed "</code></div><div><code>       # Write-Output "MSOnline does not exist needs to be installed to proceed " | Out-File $OutPutFolder -Append</code></div><div><code>        $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div><div><code>        if ($isadmin)</code></div><div><code>        {</code></div><div><code>            Install-module MSOnline -Force</code></div><div><code>        }</code></div><div><code>        else {</code></div><div><code>            Write-Host "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed"</code></div><div><code>        #    Write-Output "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed" | Out-File $OutPutFolder -Append</code></div><div><code>            Pause</code></div><div><code>        }</code></div><br><div><code>   </code></div><div><code>    }</code></div><div><code>    EditMailboxQuotas</code></div><div> </div><div><div><div><strong>The script is provided “AS IS” with no guarantees, no warranties, and it confer no rights.</strong></div><div> </div></div></div></div></div><p> </p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on May 5, 2023</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdrontoso.gr%2Fmanage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://drontoso.gr/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdrontoso.gr%2Fmanage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer" aria-label="Share with LinkedIn"><svg class="u-icon"><use xlink:href="https://drontoso.gr/assets/svg/svg-map.svg#linkedin"/></svg></a></div></aside><footer class="post__footer"><div class="post__bio box"><img class="u-author__avatar" src="https://drontoso.gr/media/website/idrosos.jpg" loading="lazy" alt="Ilias Drosos" height="450" width="450"><div><h4 class="h6"><a href="https://drontoso.gr/authors/acc/" title="Ilias Drosos">Ilias Drosos</a></h4><p>Ilias Drosos is currently working in OfficeLine as a Cloud Architect. He has extensive experience in on-premise IT enviroments with expertise on especially identity , collaboration , infrastructure and security . During his carreer he has been involved in very large migration projects , regarding Exchange on premise to online Hybrid migrations , tenant to tenant migrations (rebrands) , legacy Exchange to Modern Exchange server migrations , on-premise to cloud working enviroments (like Windows 365,Azure virtual desktop ,Intune etc.) . He is also involved in complex Microsoft Endpoint Configuration Manager architecture- design-deployments, and troubleshooting which is a product he is in love with along with Exchange , Active Directory and Intune.</p></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://drontoso.gr/move-codetwo-office-365-migration-tool-to-another-computer-not-an-exchange-server/" class="post__nav__link" rel="prev"><img src="https://drontoso.gr/media/posts/10/responsive/MoveCodeTwoToAnothercomputer-xs.png" loading="lazy" alt="" height="408" width="1024"><div class="u-small">Previous Post<h5>Move CodeTwo Office 365 Migration tool to another computer (not an exchange server)</h5></div></a></div><div class="post__nav__next"><a href="https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Exchange Public Folders Migration - SourceSideValidation script shows OrphanedMPF folders.</h5></div><img src="https://drontoso.gr/media/posts/12/responsive/microsoft-exchange-logo_resized-xs.png" loading="lazy" alt="" height="408" width="960"></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related-wrap"><figure class="post__related-item"><a href="https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/" class="c-card__image"><img src="https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-2-xs.png" loading="lazy" height="517" width="1025" alt=""></a><figcaption><h4 class="post__related-title"><a href="https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/" class="inverse">ADConnect Error - DeletingLicensedGroupNotAllowed</a></h4><time datetime="2023-01-13T09:38" class="u-small">January 13, 2023</time></figcaption></figure><figure class="post__related-item"><a href="https://drontoso.gr/email-messages-sent-through-outlook-have-a-padlock-icon-next-to-the-message-but-message-was-not-sent-encrypted/" class="c-card__image"><img src="https://drontoso.gr/media/posts/9/responsive/outlook-padlock-res-xs.png" loading="lazy" height="408" width="1024" alt=""></a><figcaption><h4 class="post__related-title"><a href="https://drontoso.gr/email-messages-sent-through-outlook-have-a-padlock-icon-next-to-the-message-but-message-was-not-sent-encrypted/" class="inverse">Email messages sent through Outlook have a padlock icon next to the message but message was not sent encrypted.</a></h4><time datetime="2022-07-12T16:38" class="u-small">July 12, 2022</time></figcaption></figure></div></div></footer></article><div class="comments-area box"></div><div class="banner banner--after-post"><div id="cusdis_thread" data-host="https://cusdis.com" data-app-id="598652a7-cf3a-4e19-a4ee-d37163ce79f8" data-page-id="{{ PAGE_ID }}" data-page-url="{{ PAGE_URL }}" data-page-title="{{ PAGE_TITLE }}"></div><script async defer="defer" src="https://cusdis.com/js/cusdis.es.js"></script></div></main><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured</h3><ul class="featured__container"><li class="featured__item"><a href="https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/" class="featured__image-link"><img src="https://drontoso.gr/media/posts/17/responsive/HCW-CertNotFound-3-xs.png" class="lazyload" loading="lazy" alt="" height="452" width="452"></a><div><a href="https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/" class="featured__title">Hybrid Configuration wizard - No Valid Certificates Found</a> <time class="u-small" datetime="2023-05-05T12:31">May 5, 2023</time></div></li><li class="featured__item"><a href="https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/" class="featured__image-link"><img src="https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-2-xs.png" class="lazyload" loading="lazy" alt="" height="517" width="517"></a><div><a href="https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/" class="featured__title">ADConnect Error - DeletingLicensedGroupNotAllowed</a> <time class="u-small" datetime="2023-01-13T09:38">January 13, 2023</time></div></li><li class="featured__item"><a href="https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/" class="featured__image-link"><img src="https://drontoso.gr/media/posts/14/responsive/IntunePCKGR-xs.png" class="lazyload" loading="lazy" alt="" height="734" width="734"></a><div><a href="https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/" class="featured__title">Automatically package and install Windows Apps to Intune Devices (without Microsoft Win32 Content Prep Tool) - intunepckgr.com</a> <time class="u-small" datetime="2022-10-31T13:05">October 31, 2022</time></div></li><li class="featured__item"><a href="https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/" class="featured__image-link"><img src="https://drontoso.gr/media/posts/13/responsive/MicrosoftIntuneM365AppsLocalSource-xs.png" class="lazyload" loading="lazy" alt="" height="533" width="533"></a><div><a href="https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/" class="featured__title">How can I install Microsoft 365 Apps via Intune from local source.</a> <time class="u-small" datetime="2022-10-25T15:10">October 25, 2022</time></div></li><li class="featured__item"><a href="https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/" class="featured__image-link"><img src="https://drontoso.gr/media/posts/12/responsive/microsoft-exchange-logo_resized-xs.png" class="lazyload" loading="lazy" alt="" height="408" width="408"></a><div><a href="https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/" class="featured__title">Exchange Public Folders Migration - SourceSideValidation script shows OrphanedMPF folders.</a> <time class="u-small" datetime="2022-10-25T11:38">October 25, 2022</time></div></li></ul></section><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><a href="https://drontoso.gr/authors/acc/" class="authors__image-link"><img src="https://drontoso.gr/media/website/idrosos.jpg" loading="lazy" alt="Ilias Drosos" height="450" width="450"></a><div><a href="https://drontoso.gr/authors/acc/" class="authors__title">Ilias Drosos</a> <span class="u-small">Post: 10</span></div></li></ul></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://drontoso.gr/tags/adconnect/">ADConnect</a> <span class="u-small">(1)</span></li><li><a href="https://drontoso.gr/tags/codetwooffice365migration/">CodeTwoOffice365Migration</a> <span class="u-small">(1)</span></li><li><a href="https://drontoso.gr/tags/exchange/">Exchange</a> <span class="u-small">(4)</span></li><li><a href="https://drontoso.gr/tags/hybrid-configuration-wizard/">Hybrid Configuration Wizard</a> <span class="u-small">(1)</span></li><li><a href="https://drontoso.gr/tags/m365-apps/">M365 Apps</a> <span class="u-small">(2)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://drontoso.gr/"><img src="https://drontoso.gr/media/website/dRONTOSO-LOGO-BLUE.jpg" alt="Drontoso"></a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright"><p>Personal Notes Blog - Use at your own risk!</p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://drontoso.gr/assets/js/scripts.min.js?v=bb66f1d815180573784f8434c8f0bf78"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>