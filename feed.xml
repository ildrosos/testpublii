<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/">
    <title>Drontoso</title>
    <link href="https://drontoso.gr/feed.xml" rel="self" />
    <link href="https://drontoso.gr" />
    <updated>2023-05-05T12:51:12+03:00</updated>
    <author>
        <name>Ilias Drosos</name>
    </author>
    <id>https://drontoso.gr</id>

    <entry>
        <title>Hybrid Configuration wizard - No Valid Certificates Found</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/"/>
        <id>https://drontoso.gr/hybrid-configuration-wizard-no-valid-certificates-found/</id>
        <media:content url="https://drontoso.gr/media/posts/17/HCW-CertNotFound-3.png" medium="image" />
            <category term="Hybrid Configuration Wizard"/>
            <category term="HCW"/>
            <category term="ExchangeOnline"/>
            <category term="Exchange On Premise"/>

        <updated>2023-05-05T12:51:12+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/17/HCW-CertNotFound-3.png" alt="" />
                    Recently I had a case where a customer wanted to add a second exchange server in HCW to host receive and send connectors for redundancy .&nbsp; The problem was that the server was in a different site and child domain than the "primary" exchange server&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/17/HCW-CertNotFound-3.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    Recently I had a case where a customer wanted to add a second exchange server in HCW to host receive and send connectors for redundancy .&nbsp;
  </p>

  <p>
    The problem was that the server was in a different site and child domain than the "primary" exchange server which was already part of HCW.&nbsp;
  </p>

  <p>
    As shown in the screenshot after selecting which servers you need to host Receive/Send connectors you need to select the Transport Certificate which will be used when connecting to Office 365.&nbsp;
  </p>

  <p>
    At this point I had the error : No valid certificates found for our 1st exchange server .&nbsp;
  </p>

  <p>
    After checking the server I identified that this was not true . The server had a valid cert and of course if you tried to run HCW from that server the error was gone.&nbsp;
  </p>

  <p>
    So what is the problem in this case ? The problem is that HCW is trying to query the server with the hostname as shown in the screenshot not the FQDN . But as mentioned the HCW was run in a different domain than the domain that the server in question was installed to . That said the hostname was not resolved to a real IP address .
  </p>

  <p>
    So to overcome the problem you need to either&nbsp; :&nbsp;
  </p>

  <p>
    Add a record to your local DNS server with the server name and the server IP or&nbsp;
  </p>

  <p>
    Add a hostfile&nbsp; to your exchange server which will point to the real IP of the server we are looking for like this :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/17/ostfile.png" height="305" width="513" alt="hostfile"  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/17/responsive/ostfile-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/ostfile-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/ostfile-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/ostfile-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/ostfile-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/ostfile-2xl.png 1600w">
      
    </figure>

  <p>
    After that if you did not close the HCW you will see this instead of the initial error :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/17/HCW-WAITING.png" height="590" width="608" alt="HCW - waiting"  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/HCW-WAITING-2xl.png 1600w">
      
    </figure>

  <p>
    I gave it about 30 mins with no result so I decided to make a coffee , and close and reopen HCW wizard after about 30 mins or so . This was the result :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/17/HCW-BOOOOM.png" height="508" width="566" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-xs.png 300w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-sm.png 480w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-md.png 768w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-lg.png 1024w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-xl.png 1360w ,https://drontoso.gr/media/posts/17/responsive/HCW-BOOOOM-2xl.png 1600w">
      
    </figure>

  <p>
    Boom , case closed. Cheers!
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>ADConnect Error - DeletingLicensedGroupNotAllowed</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/"/>
        <id>https://drontoso.gr/adconnect-error-deletinglicensedgroupnotallowed/</id>
        <media:content url="https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect-2.png" medium="image" />
            <category term="ADConnect"/>

        <updated>2023-05-05T12:51:07+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect-2.png" alt="" />
                    If you ever delete a group in Azure AD which is used for Group Licensing purposes you will receive an error in ADConnect similar to the screenshot above .&nbsp; The error states : "DeletingLicensedGroupNotAllowed" The problem is that AD Connect does not specifically tell you&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect-2.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/15/DeletingLicensedGroupNotAllowedADConnect.png" height="517" width="1025" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-xs.png 300w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-sm.png 480w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-md.png 768w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-lg.png 1024w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-xl.png 1360w ,https://drontoso.gr/media/posts/15/responsive/DeletingLicensedGroupNotAllowedADConnect-2xl.png 1600w">
      <figcaption>DeletingLicensedGroupNotAllowed</figcaption>
    </figure>

  <p>
    If you ever delete a group in Azure AD which is used for Group Licensing purposes you will receive an <b>error</b> in <b>ADConnect </b>similar to the screenshot above .&nbsp;
  </p>

  <p>
    The error states : "<b>DeletingLicensedGroupNotAllowed</b>"
  </p>

  <p>
    The problem is that AD Connect does not specifically tell you which AD Group caused the problem. In most situations you realise you have an error in AD Connect a few hours or days later .&nbsp;
  </p>

  <p>
    What if it was Azure Active Directory clean up day and you deleted 200 groups ? How can I find which group is causing the problem ?&nbsp;&nbsp;
  </p>

  <p>
    
  </p>

  <p>
    Navigate to <b>Azure Active Directory</b> - &gt; <b>Groups </b>and then <b>Audit Logs </b>.&nbsp;
  </p>

  <p>
    Click add <b>filters </b>and add <b>Status</b> . Then choose <b>failure </b>for <b>status </b>. Obviously within the failures you will find the one you are looking for . To resolve the error <b>remove the license assignment from the group</b> so the group can be deleted.
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Automatically package and install Windows Apps to Intune Devices (without Microsoft Win32 Content Prep Tool) - intunepckgr.com</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/"/>
        <id>https://drontoso.gr/automatically-package-and-install-windows-apps-to-intune-devices-without-microsoft-win32-content-prep-tool/</id>
        <media:content url="https://drontoso.gr/media/posts/14/IntunePCKGR.png" medium="image" />
            <category term="Microsoft Intune"/>

        <updated>2022-10-31T17:02:36+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/14/IntunePCKGR.png" alt="" />
                    What if I told you that there is a service which can package and install all popular Windows Apps as Win32 Apps to your Intune Devices with just a few clicks? What if it can also maintain and automatically update the apps whenever a new&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/14/IntunePCKGR.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    What if I told you that there is a service which can package and install all popular Windows Apps as Win32 Apps to your Intune Devices with just a few clicks?
  </p>

  <p>
    What if it can also maintain and automatically update the apps whenever a new version is available ?&nbsp;
  </p>

  <p>
    And what If the tool could do the same for all your InTune tenants ?&nbsp;
  </p>

    <blockquote class="blockquote">
      <strong>And what if you could do all of the above for free ?? (For now at least)&nbsp;</strong>
    </blockquote>

  <p>
    Go ahead and join the beta program from&nbsp;<a href="https://intunepckgr.com/" target="_blank">https://intunepckgr.com/</a>
  </p>

  <p>
    
  </p>

  <p>
    Once joined visit your companies tab to add a new company :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/14/IntunePckgrMyCompanies.png" height="602" width="1381" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/IntunePckgrMyCompanies-2xl.png 1600w">
      
    </figure>

  <p>
    Once added select it and click connect to Intune&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/14/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard.png" height="237" width="482" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_00_52-Intune-Pckgr-_-Dashboard-2xl.png 1600w">
      
    </figure>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/14/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard.png" height="527" width="484" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-13_01_58-Intune-Pckgr-_-Dashboard-2xl.png 1600w">
      
    </figure>

  <p>
    After following the prompts to sign in etc. you will be redirected back to your profile in Intunepckgr.&nbsp;
  </p>

  <p>
    Go ahead and click on App Library&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/14/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard.png" height="611" width="1384" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_45_08-Intune-Pckgr-_-Dashboard-2xl.png 1600w">
      
    </figure>

  <p>
    Select your organization and click on Add App.&nbsp;
  </p>

  <p>
    Here you are presented with a quite large list with popular windows apps ready to be deployed. When selecting an app your are presented with the option to auto-update the app . That means that whenever a new version of the app is launched the service deploys the new version to your Intune tenant and if you have assigned the app as required for one or more groups the app gets updated on the endpoint without end-user or admin interaction!&nbsp;
  </p>

  <p>
    After you have selected the apps of your choice wait for the app to be deployed and then head back to intune to check and assign the apps.&nbsp;
  </p>

  <p>
    Look at my apps inside Intune for example :
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/14/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn.png" height="836" width="1603" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-xs.png 300w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-sm.png 480w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-md.png 768w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-lg.png 1024w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-xl.png 1360w ,https://drontoso.gr/media/posts/14/responsive/2022-10-31-16_50_42-2022-10-31-16_48_56-Windows-Microsoft-Endpoint-Manager-admin-center-Opera.pn-2xl.png 1600w">
      
    </figure>

  <p>
    So I have in total 13 win32 apps ready to be deployed , or uninstalled with the command lines needed to work ready and tested. I also have the ability to auto-update the apps for my Intune Managed Endpoints whenever a new version of the app is available and the service deploys it . How much time did that take ? Almost as much as I needed to package , test, and deploy 1 of them ! About 20 minutes from account creation to deployment !&nbsp;
  </p>

  <p>
    And if you ever have a problem , such as app not deploying to your tenant , or app deployed and assigned but not getting installed on your endpoints just talk to support through the online chat at&nbsp;<a href="https://intunepckgr.com/">https://intunepckgr.com/</a>&nbsp;. I am sure you will get a response within minutes with a solution to the problem . These guys are lightning fast!
  </p>

  <p>
    This is really a game changer ! Kudos @intunepckgr and especially&nbsp;Dale Flanagan (linkedin :&nbsp;<a href="https://www.linkedin.com/in/daleflanagan/">https://www.linkedin.com/in/daleflanagan/</a>&nbsp;who is the man responsible behind the project!
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>How can I install Microsoft 365 Apps via Intune from local source.</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/"/>
        <id>https://drontoso.gr/how-can-i-install-microsoft-365-apps-via-intune-from-local-source/</id>
        <media:content url="https://drontoso.gr/media/posts/13/MicrosoftIntuneM365AppsLocalSource.png" medium="image" />
            <category term="Microsoft Intune"/>
            <category term="M365 Apps"/>

        <updated>2022-10-31T12:51:10+02:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/13/MicrosoftIntuneM365AppsLocalSource.png" alt="" />
                    Did you know you can initiate Microsoft 365 Apps via Intune when the source files are in your file server? Nor did I.&nbsp; Usecase : Customer needs to be able to push Microsoft 365 Apps via intune but network bandwidth is a huge stopper when&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/13/MicrosoftIntuneM365AppsLocalSource.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    Did you know you can initiate Microsoft 365 Apps via Intune when the source files are in your file server? Nor did I.&nbsp;
  </p>

  <p>
    Usecase : Customer needs to be able to push Microsoft 365 Apps via intune but network bandwidth is a huge stopper when multiple (thousands) Windows Devices try to reach Office CDN and download the required setup files.&nbsp;
  </p>

  <p>
    So you allow all Intune Management Urls in order to manage endpoints via Intune but do not want to allow Office CDN Urls access to control bandwidth within the organization .&nbsp;
  </p>

  <p>
    Well there is a way to do that.&nbsp;
  </p>

  <p>
    There is only 1 Requirement . Your file server or any server which will download the required setup files needs to have proper Internet access only once. When the server downloads the setup files. Internet Access can be prohibited afterwards.&nbsp;
  </p>

  <p>
    So go ahead and download Office Deployment tool :&nbsp;<a href="https://learn.microsoft.com/en-us/deployoffice/overview-office-deployment-tool" class="" target="_blank">https://learn.microsoft.com/en-us/deployoffice/overview-office-deployment-tool</a>
  </p>

  <p>
    Next go to Office Customization Tool :&nbsp;<a href="https://config.office.com/deploymentsettings" class="" target="_blank">https://config.office.com/deploymentsettings</a>
  </p>

  <p>
    Choose which apps you need to be installed on the Windows Clients (managed by Intune) and of course the rest of the settings like languages&nbsp; ,activation etc.&nbsp;
  </p>

  <p>
    Do not forget to add the local source the office files will reside on for example:&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/13/IntuneOfficeInstallationViaLocalSource.png" height="289" width="857" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/IntuneOfficeInstallationViaLocalSource-2xl.png 1600w">
      
    </figure>

  <p>
    Export the configuration xml let's say it's called configuration.xml.
  </p>

  <p>
    Now login to the server which will host the setup files .&nbsp;
  </p>

  <p>
    Move configuration.xml and Office Deployment tool to the server. Create a shared folder with proper permissions so your windows devices can reach and read the setup files.&nbsp;
  </p>

  <p>
    Run setup.exe with the configuration.xml and the download switch for example :&nbsp;
  </p>

  <p>
    setup.exe /download configuration.xml
  </p>

  <p>
    Wait for the download process to complete . While waiting copy the content of configuration.xml to notepad .&nbsp;
  </p>

  <p>
    Go ahead and create a new app within intune of type Microsoft 365 Apps :
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/13/Microsoft365-Apps.png" height="250" width="568" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/Microsoft365-Apps-2xl.png 1600w">
      
    </figure>

  <p>
    At the configure app suite step choose Enter XML Data&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/13/ConfigurationDesignerXML.png" height="662" width="843" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-xs.png 300w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-sm.png 480w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-md.png 768w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-lg.png 1024w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-xl.png 1360w ,https://drontoso.gr/media/posts/13/responsive/ConfigurationDesignerXML-2xl.png 1600w">
      
    </figure>

  <p>
    Paste the configuration.xml data you have from notepad inside the XML Data and validate the XML . When XML is validated go ahead and assign the&nbsp; app .&nbsp;
  </p>

  <p>
    Done!
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Exchange Public Folders Migration - SourceSideValidation script shows OrphanedMPF folders.</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/"/>
        <id>https://drontoso.gr/exchange-public-folders-migration-sourcesidevalidation-script-shows-orphanedmpf-folders/</id>
        <media:content url="https://drontoso.gr/media/posts/12/microsoft-exchange-logo_resized.png" medium="image" />
            <category term="PublicFolders Migration"/>
            <category term="ExchangeOnline"/>
            <category term="Exchange On Premise"/>

        <updated>2022-10-25T13:31:57+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/12/microsoft-exchange-logo_resized.png" alt="" />
                    So you are trying to run SourceSideVaildation.ps1 script provided from MS&nbsp;and find out OrphanedMPF objects that the script indicates that need to be cleaned up . The output of the script shows something like this :&nbsp; As granikos explains in more detail : https://granikos.eu/exchange-public-folder-meso-object-not-deleted/ So&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/12/microsoft-exchange-logo_resized.png" class="type:primaryImage" alt="" /></p>
                
  <p>
    So you are trying to run SourceSideVaildation.ps1 script provided from <a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/making-your-public-folder-migrations-faster-and-more-reliable/ba-p/917622" target="_blank">MS</a>&nbsp;and find out OrphanedMPF objects that the script indicates that need to be cleaned up . The output of the script shows something like this :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/12/OrphanedMPFs.png" height="36" width="744" alt="OrphanedMPFs"  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-xs.png 300w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-sm.png 480w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-md.png 768w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-lg.png 1024w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-xl.png 1360w ,https://drontoso.gr/media/posts/12/responsive/OrphanedMPFs-2xl.png 1600w">
      
    </figure>

  <p>
    As granikos explains in more detail : <a href="https://As granikos explains in more detail : https://granikos.eu/exchange-public-folder-meso-object-not-deleted/">https://granikos.eu/exchange-public-folder-meso-object-not-deleted/</a>
  </p>

  <p>
    So the next thing to do is to find the orphaned entries and delete them .&nbsp;
  </p>

  <p>
    So after searching ADSI in the appropriate path I found 2 entries as expected :&nbsp;
  </p>

    <figure class="post__image post__image--center">
      <img loading="lazy" src="https://drontoso.gr/media/posts/12/PublicFoldersADSI.png" height="448" width="1027" alt=""  sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-xs.png 300w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-sm.png 480w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-md.png 768w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-lg.png 1024w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-xl.png 1360w ,https://drontoso.gr/media/posts/12/responsive/PublicFoldersADSI-2xl.png 1600w">
      
    </figure>

  <p>
    <br>
  </p>

  <p>
    The right one to delete is the one without random numbers after it's name but to be sure check the when created date. As you noticed the one with the random numbers was indeed created after the one without numbers. This confirms that the one without random numbers is the right one that needs to be deleted.&nbsp;
  </p>

  <p>
    In my case after re-running the script the folder with the number re-appeared in suggestions . This confirms that the folder is no longer mail-enabled and the entries have to be deleted (both) . But to be sure check if the public folder is mail-enabled before deleting both entries.
  </p>

  <p>
    
  </p>

  <p>
    
  </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Manage Exhange Online Mailbox Quotas based on group membership through Powershell</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/"/>
        <id>https://drontoso.gr/manage-exhange-online-mailbox-quotas-based-on-group-membership-through-powershell/</id>
        <media:content url="https://drontoso.gr/media/posts/11/mailboxquotas.png" medium="image" />
            <category term="PowerShellScripts"/>
            <category term="ExchangeOnline"/>

        <updated>2022-07-13T16:38:46+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/11/mailboxquotas.png" alt="" />
                    If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/11/mailboxquotas.png" class="type:primaryImage" alt="" /></p>
                <p>If you need to change Office365 mailbox quotas the only way to do so is via Powershell. In addition there is not way to control quotas via groups for example or any policy to assign in order to assisgn for example X GBs quota to sales department . </p>
<p>For that reason I created the Powershell script below . </p>
<p>Feel free to change / share / comment .</p>
<p>Script contains parts of the script originally posted by </p>
<div>Johan Dahlbom from 365lab.net so credits to Johan :D </div>
<div> </div>
<p>Script Logic : </p>
<ul>
<li>Checks if the script was run under admin privileges otherwise informs the user to rerun with admin privs.</li>
<li>Checks if MSOnline and Exchange Online Modules are installed . </li>
<li>If they are not it tries to install them . </li>
<li>Checks if there are active MSOnline and Exchange Online Sessions. If there are not it prompts you to enter credentials to connect .</li>
<li>Asks the user to provide the name of the group which will get the following quota policy (of course you can change the values to suit your needs) : 
<div>ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</div>
<div>Asks  the user to provide the script output folder (usefull when you run it against multiple users) . </div>
</li>
<li>Then it changes all group's members quota to the one mentioned above</li>
<li>And also changes all other users quotas to 
<div>ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</div>
</li>
</ul>
<p>The Script : </p>
<div>
<div>
<div> </div>
</div>
</div>
<div>
<div>
<div><code>function EditMailboxQuotas {</code></div>
<div><code>    $OutPutFolder = "c:\temp\EditMailboxQuotas.txt"</code></div>
<div><code>    $SpecificUserQuota=$null</code></div>
<div><code>    $ConvertedQuotaToKB = $null</code></div>
<div><code>    Write-Host "Please input the name of the group members of which will be assigned 5GB Quota"</code></div>
<div><code>        $ADGroup = Read-Host -Prompt 'Input the group name'</code></div>
<div><code>        Write-Host "Input the folder to export all script output - Please include file name as well" -ForegroundColor Green</code></div>
<div><code>        $OutPutFolder = Read-Host -Prompt 'Folder path and file name to export output to "Example:c:\filename.txt"'</code></div>
<div><code>       </code></div>
<div><code>        Write-Host "Searching for Group " $ADGroup</code></div>
<div><code>        Write-Output "Searching for Group " $ADGroup | Out-File $OutPutFolder -Append</code></div>
<div><code>        Import-Module AzureAD</code></div>
<div><code>        Import-Module MSOnline</code></div>
<div><code>        Import-Module ExchangeOnlineManagement</code></div>
<div><code>        #Connect-MsolService</code></div>
<div><code>        $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div>
<div><code>            if (-not($MSOLAccountSku)) {</code></div>
<div><code>                Connect-MsolService</code></div>
<div><code>            }</code></div>
<div><code>        $getsessions = Get-PSSession | Select-Object -Property State, Name</code></div>
<div><code>        #Connect-ExchangeOnline</code></div>
<div><code>        $IsconnectedToEOL = (@($getsessions) -like '@{State=Opened; Name=ExchangeOnlineInternalSession*').Count -gt 0</code></div>
<div><code>            If ($IsconnectedToEOL -ne "True") {</code></div>
<div><code>            Connect-ExchangeOnline</code></div>
<div><code>            }  </code></div>
<div><code>        #Connect-ExchangeOnline</code></div>
<div><code>        $MSOLGroup = Get-MsolGroup -SearchString $ADGroup</code></div>
<div><code>        Write-Host "Group's id is  " $MSOLGroup.ObjectId</code></div>
<div><code>        Write-Output "Group's id is  " $MSOLGroup.ObjectId | Out-File $OutPutFolder -Append</code></div>
<div><code>        write-host "------------- Configuring quotas for all users who are members of the group  " $ADGroup "-------------" -ForegroundColor Magenta</code></div>
<div><code>        Write-Output "------------- Configuring quotas for all users who are members of the group  " $ADGroup "-------------" | Out-File $OutPutFolder -Append</code></div>
<div><code>        Read-Host -Prompt "Press any key to continue configuring quotas for all users who are members of the group to 5GB or CTRL+C to quit"</code></div>
<div><code>        Start-Sleep -Seconds 3</code></div>
<div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)</code></div>
<div><code>        if($null -ne $UsersWithinGroup)</code></div>
<div><code>            {#Check if mailbox quota more than 5gb</code></div>
<div><code>            foreach ($UserWithinGroup in $UsersWithinGroup)</code></div>
<div><code>             {     $UserWithinGroup.EmailAddress</code></div>
<div><code>                   $SpecificUserQuota = Get-Mailbox $UserWithinGroup.EmailAddress | Select-Object ProhibitSendReceiveQuota</code></div>
<div><code>           </code></div>
<div><code>                   $ConvertedQuotaToKB = Convert-QuotaStringToKB($SpecificUserQuota)</code></div>
<div><code>             If($ConvertedQuotaToKB -gt 5242880 ) {#quota is more than 5gb</code></div>
<div><code>                Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota more than 5gb will check mailbox size" -ForegroundColor Cyan</code></div>
<div><code>                Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota more than 5gb will check mailbox size" | Out-File $OutPutFolder -Append</code></div>
<div><code>                ##Check if mailbox size is more than 4.5</code></div>
<div><code>                $MailboxSize =  Get-MailboxStatistics $UserWithinGroup.EmailAddress | Select-Object TotalItemSize</code></div>
<div><code>                $MailboxSizeInKB = Convert-QuotaStringToKB($MailboxSize)</code></div>
<div><code>                    if ($MailboxSizeInKB -gt 4718592){#If user mailbox size is more than 4.5 GB</code></div>
<div><code>                        Write-Host "Mailbox size is more than 4.5 GB No changes will be made " -ForegroundColor Red</code></div>
<div><code>                        Write-Output "Mailbox size is more than 4.5 GB No changes will be made " -Append</code></div>
<div><code>                        #do Nothing</code></div>
<div><code>                            }    #If user mailbox size is more than 4.5 GB</code></div>
<div><code>                        if ($MailboxSizeInKB -lt 4718592) {#Mailbox size is less than 4.5 GB</code></div>
<div><code>                        Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $MailboxSizeInKB "KB mailbox size mailbox quota will be changed" -ForegroundColor Green</code></div>
<div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $MailboxSizeInKB "KB mailbox size mailbox quota will be changed" | Out-File $OutPutFolder -Append</code></div>
<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>
<div><code>                           </code></div>
<div><code>                        $SpecificUserQuota = $null</code></div>
<div><code>                            }   #Mailbox size is less than 4.5 GB</code></div>
<div><code>                        }              </code></div>
<div><code>                        elseif ($ConvertedQuotaToKB -eq 5242880 ) { #quota is 5gb</code></div>
<div><code>                            ##Do nothing</code></div>
<div><code>                         Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota 5gb Nothing will be changed"  -ForegroundColor Red</code></div>
<div><code>                         Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota 5gb Nothing will be changed" | Out-File $OutPutFolder -Append</code></div>
<div><code>                         $SpecificUserQuota = $null</code></div>
<div><code>                        }</code></div>
<div><code>                   </code></div>
<div><code>                        elseIf ($UserWithinGroup.UseDatabaseQuotaDefaults) #quota used from db defaults</code></div>
<div><code>                        {   Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "uses defaults changing"  -ForegroundColor Red</code></div>
<div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "uses defaults changing" | Out-File $OutPutFolder -Append</code></div>
<div><code>                       </code></div>
<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>
<div><code>                        }</code></div>
<div><code>                        elseif ($ConvertedQuotaToKB -lt 5242880) #quota is less than 5gb and not db defaults</code></div>
<div><code>                        {   Write-Host "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota less than 5gb Quotas will be changed"  -ForegroundColor Green</code></div>
<div><code>                        Write-Output "CurrentUser" $UserWithinGroup.EmailAddress "has" $ConvertedQuotaToKB "KB Quota less than 5gb Quotas will be changed" | Out-File $OutPutFolder -Append</code></div>
<div><code>                        set-Mailbox $UserWithinGroup.EmailAddress -ProhibitSendQuota 4.5gb -ProhibitSendReceiveQuota 5gb -IssueWarningQuota 3.9gb</code></div>
<div><code>                        }</code></div>
<div><code>           </code></div>
<div><code>        }#ForEach</code></div>
<div><code>    }#If</code></div>
<br>
<div><code>        else {</code></div>
<div><code>            #GroupIsEmpty</code></div>
<div><code>        }</code></div>
<br>
<div><code>       </code></div>
<div><code>        write-host "------------- Configuring quotas for all users EXCLUDING those who are members of the group " $ADGroup "-------------" -ForegroundColor Magenta</code></div>
<div><code>        Write-Output write-host "------------- Configuring quotas for all users EXCLUDING those who are members of the group " $ADGroup "-------------" | Out-File $OutPutFolder -Append</code></div>
<div><code>        Read-Host -Prompt "Press any key to continue configuring quotas for ALL usersof the organization who are not members of the group to 80GB or CTRL+C to quit"</code></div>
<div><code>        Start-Sleep -Seconds 3</code></div>
<div><code>        $UsersWithinGroup = Get-JDMsolGroupMember($MSOLGroup.ObjectId)  </code></div>
<div><code>        $EXOMailboxes = Get-EXOMailbox -RecipientTypeDetails UserMailbox</code></div>
<div><code>    foreach($EXOMailbox in $EXOMailboxes)</code></div>
<div><code>        {write-host "For mailbox  "$EXOMailbox.primarySMtpaddress -ForegroundColor White</code></div>
<div><code>        Write-Output "For mailbox  "$EXOMailbox.primarySMtpaddress | Out-File $OutPutFolder -Append</code></div>
<div><code>            if(!(Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress}))</code></div>
<div><code>                {write-host "Configuring Quota For mailbox  "$EXOMailbox.primarySMtpaddress " to 80GB" -ForegroundColor Green</code></div>
<div><code>                Write-Output "Configuring Quota For mailbox  "$EXOMailbox.primarySMtpaddress " to 80GB" | Out-File $OutPutFolder -Append</code></div>
<div><code>                set-Mailbox $EXOMailbox.primarySMtpaddress -ProhibitSendQuota 75gb -ProhibitSendReceiveQuota 80gb -IssueWarningQuota 74gb</code></div>
<div><code>                     </code></div>
<div><code>                }#if</code></div>
<div><code>                elseif (Get-MsolGroupMember -GroupObjectId $MSOLGroup.ObjectId | Where-Object {$_.EmailAddress -eq $EXOMailbox.primarySMtpaddress})</code></div>
<div><code>                {  </code></div>
<div><code>                    write-host "For mailbox  "$EXOMailbox.primarySMtpaddress "Nothing will be changed because user is a member of the group" $ADGroup -ForegroundColor red  </code></div>
<div><code>                    Write-Output "For mailbox  "$EXOMailbox.primarySMtpaddress "Nothing will be changed because user is a member of the group" $ADGroup | Out-File $OutPutFolder -Append</code></div>
<div><code>                }</code></div>
<div><code>               </code></div>
<div><code>        }#ForEachEXOMailbox</code></div>
<div><code>        Write-Host "All quotas configuration is finished . If you need to change quotas again re-run the script."  -ForegroundColor Gray</code></div>
<div><code>        Write-Output  "All quotas configuration is finished . If you need to change quotas again re-run the script." | Out-File $OutPutFolder -Append</code></div>
<div><code>}#FunctionEditMailboxQuotas  </code></div>
<div><code>Function Convert-QuotaStringToKB() {</code></div>
<br>
<div><code>    Param([string]$CurrentQuota)</code></div>
<br>
<div><code>    [string]$CurrentQuota = ($CurrentQuota.Split("("))[1]</code></div>
<div><code>    [string]$CurrentQuota = ($CurrentQuota.Split(" bytes)"))[0]</code></div>
<div><code>    $CurrentQuota = $CurrentQuota.Replace(",","")</code></div>
<div><code>    [int]$CurrentQuotaInKB = "{0:F0}" -f ($CurrentQuota/1024)</code></div>
<br>
<div><code>    return $CurrentQuotaInKB</code></div>
<div><code>}</code></div>
<br>
<div><code>Function Get-JDMsolGroupMember {</code></div>
<div> </div>
<div><code>       </code></div>
<div><code>        param(</code></div>
<div><code>            [CmdletBinding(SupportsShouldProcess=$true)]</code></div>
<div><code>            [Parameter(Mandatory=$true, ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true,Position=0)]</code></div>
<div><code>            [ValidateScript({Get-MsolGroup -ObjectId $_})]</code></div>
<div><code>            $ObjectId,</code></div>
<div><code>            [switch]$Recursive</code></div>
<div><code>        )</code></div>
<div><code>        begin {</code></div>
<div><code>            $MSOLAccountSku = Get-MsolAccountSku -ErrorAction Ignore -WarningAction Ignore</code></div>
<div><code>            if (-not($MSOLAccountSku)) {</code></div>
<div><code>                throw "Not connected to Azure AD, run Connect-MsolService"</code></div>
<div><code>            }</code></div>
<div><code>        }</code></div>
<div><code>        process {</code></div>
<div><code>            Write-Verbose -Message "Enumerating group members in group $ObjectId"</code></div>
<div><code>            [array]$UserMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes User -All</code></div>
<div><code>            if ($PSBoundParameters['Recursive']) {</code></div>
<div><code>                $GroupsMembers = Get-MsolGroupMember -GroupObjectId $ObjectId -MemberObjectTypes Group -All</code></div>
<div><code>                if ($GroupsMembers) {</code></div>
<div><code>                    Write-Verbose -Message "$ObjectId have $($GroupsMembers.count) group(s) as members, enumerating..."</code></div>
<div><code>                    $GroupsMembers | ForEach-Object -Process {</code></div>
<div><code>                        Write-Verbose "Enumerating nested group $($_.Displayname) ($($_.ObjectId))"</code></div>
<div><code>                        $UserMembers += Get-JDMsolGroupMember -Recursive -ObjectId $_.ObjectId</code></div>
<div><code>                    }</code></div>
<div><code>                }</code></div>
<div><code>            }</code></div>
<div><code>            Write-Output ($UserMembers | Sort-Object -Property EmailAddress -Unique)</code></div>
<div><code>               </code></div>
<div><code>        }</code></div>
<div><code>        end {</code></div>
<div><code>           </code></div>
<div><code>        }</code></div>
<div><code>    }</code></div>
<br><br>
<div><code>if (Get-Module -Name ExchangeOnlineManagement) {</code></div>
<div><code>    Write-Host "Exchange online Module installed proceeding to next steps"</code></div>
<div><code>    #Write-Output  "Exchange online Module installed proceeding to next steps"| Out-File $OutPutFolder -Append</code></div>
<div><code>    Start-Sleep -Seconds 2</code></div>
<div><code>}</code></div>
<div><code>else {</code></div>
<div><code>    Write-Host "Exchange online Module does not exist needs to be installed to proceed "</code></div>
<div><code>    #Write-Output  "Exchange online Module does not exist needs to be installed to proceed " | Out-File $OutPutFolder -Append</code></div>
<div><code>    Start-Sleep -Seconds 2</code></div>
<div><code>    $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div>
<div><code>    if ($isadmin)</code></div>
<div><code>    {   Write-Host "Installing Exchange online Module .... "</code></div>
<div><code>    #Write-Output "Installing Exchange online Module .... " | Out-File $OutPutFolder -Append</code></div>
<div><code>        Install-module ExchangeOnlineManagement -Force        </code></div>
<div><code>    }</code></div>
<div><code>    else {</code></div>
<div><code>        Write-Host "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed"</code></div>
<div><code>       # Write-Output "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed" | Out-File $OutPutFolder -Append</code></div>
<div><code>        Pause</code></div>
<div><code>    }</code></div>
<div><code>}</code></div>
<div><code>if (Get-Module -Name MSOnline) {</code></div>
<div><code>        Write-Host "MSOnline online Module installed proceeding to next steps"</code></div>
<div><code>       # Write-Output "MSOnline online Module installed proceeding to next steps" | Out-File $OutPutFolder -Append</code></div>
<div><code>        Start-Sleep -Seconds 2</code></div>
<div><code>    }</code></div>
<div><code>else {</code></div>
<div><code>        Write-Host "MSOnline does not exist needs to be installed to proceed "</code></div>
<div><code>       # Write-Output "MSOnline does not exist needs to be installed to proceed " | Out-File $OutPutFolder -Append</code></div>
<div><code>        $isadmin = (New-Object Security.Principal.WindowsPrincipal([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)</code></div>
<div><code>        if ($isadmin)</code></div>
<div><code>        {</code></div>
<div><code>            Install-module MSOnline -Force</code></div>
<div><code>        }</code></div>
<div><code>        else {</code></div>
<div><code>            Write-Host "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed"</code></div>
<div><code>        #    Write-Output "It Appears you did not run the script with administrative rights please run the script with administrative rights to proceed" | Out-File $OutPutFolder -Append</code></div>
<div><code>            Pause</code></div>
<div><code>        }</code></div>
<br>
<div><code>   </code></div>
<div><code>    }</code></div>
<div><code>    EditMailboxQuotas</code></div>
<div> </div>
<div>
<div>
<div><strong>The script is provided “AS IS” with no guarantees, no warranties, and it confer no rights.</strong></div>
<div> </div>
</div>
</div>
</div>
</div>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Move CodeTwo Office 365 Migration tool to another computer (not an exchange server)</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/move-codetwo-office-365-migration-tool-to-another-computer-not-an-exchange-server/"/>
        <id>https://drontoso.gr/move-codetwo-office-365-migration-tool-to-another-computer-not-an-exchange-server/</id>
        <media:content url="https://drontoso.gr/media/posts/10/MoveCodeTwoToAnothercomputer.png" medium="image" />
            <category term="CodeTwoOffice365Migration"/>

        <updated>2022-07-21T12:28:48+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/10/MoveCodeTwoToAnothercomputer.png" alt="" />
                    If you need to move CodeTwo Office 365 Migration tool to another computer but do not want to purge mailboxes which were already processed and start over (to avoid duplicates creation) you need to follow the workaround mentioned in the document below to migrate settings&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/10/MoveCodeTwoToAnothercomputer.png" class="type:primaryImage" alt="" /></p>
                <p>If you need to move CodeTwo Office 365 Migration tool to another computer but do not want to purge mailboxes which were already processed and start over (to avoid duplicates creation) you need to follow the workaround mentioned in the document below to migrate settings and cache objects of the software to the new computer: <a href="https://www.codetwo.com/userguide/exchange-rules-pro/reinstall-or-move.htm" target="_blank" rel="noopener noreferrer">CodeTwo Documentation</a></p>
<p>What CodeTwo does not mention in the article is that you need to have Messaging Api And Collaboration Data Objects 1.2.1 installed on the computer in case you are trying to migrate from Exchange 2003 or 2007. </p>
<p>If you already have office installed on your computer you need to remove it first before installing CodeTwo as per the guide's instructions. If you don't <strong>like I did </strong>Messaging Api won't be installed automatically and you won't be able to start the jobs or reconfigure the source server connection. </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/10/MessagingAndCollaborationAPI-6.png" alt="MessagingAndCollaborationApi" width="1007" height="640" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-xs.png 300w ,https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-sm.png 480w ,https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-md.png 768w ,https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-lg.png 1024w ,https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-xl.png 1360w ,https://drontoso.gr/media/posts/10/responsive/MessagingAndCollaborationAPI-6-2xl.png 1600w"></figure>
<p>You can always remove and reinstall after removing Office from the "host" computer but you can also navigate to Add/Remove Programs and repair the installation of CodeTwo . If you do so a message will popup which indicates that Messaging Api And Collaboration Data Objects 1.2.1 is not installed on the computer and ask if you want the software to be installed. If you do so source server connection will be established .</p>
<p>When you try to restart your jobs you will get another error indicating that a certificate with a particular thumbprint is missing from the computer so the jobs will fail to start. </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/10/CodeTwoMissingCertError.png" alt="CodeTwoMissingCertError" width="385" height="168" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-xs.png 300w ,https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-sm.png 480w ,https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-md.png 768w ,https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-lg.png 1024w ,https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-xl.png 1360w ,https://drontoso.gr/media/posts/10/responsive/CodeTwoMissingCertError-2xl.png 1600w"></figure>
<p>You can then export the required certificate and import it to your "host" computer under User/Personal store. </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/10/ExportCodeTwoCertFromSourceServer.png" alt="ExportCodeTwoCertFromSourceServer" width="1034" height="622" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-xs.png 300w ,https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-sm.png 480w ,https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-md.png 768w ,https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-lg.png 1024w ,https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-xl.png 1360w ,https://drontoso.gr/media/posts/10/responsive/ExportCodeTwoCertFromSourceServer-2xl.png 1600w"></figure>
<p>After that all migrations will start like you were in your old machine and mail duplicates won't exist. No need to purge your mailboxes either this way. </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Email messages sent through Outlook have a padlock icon next to the message but message was not sent encrypted.</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/email-messages-sent-through-outlook-have-a-padlock-icon-next-to-the-message-but-message-was-not-sent-encrypted/"/>
        <id>https://drontoso.gr/email-messages-sent-through-outlook-have-a-padlock-icon-next-to-the-message-but-message-was-not-sent-encrypted/</id>
        <media:content url="https://drontoso.gr/media/posts/9/outlook-padlock-res.png" medium="image" />
            <category term="Outlook"/>

        <updated>2022-07-21T12:31:12+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/9/outlook-padlock-res.png" alt="" />
                    Sometimes you choose to send a message through outlook with a digital signature but without enryption. If you check your sent messages there is a padlock icon next to each message but you've sent the message without encryption : This is happening because the following&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/9/outlook-padlock-res.png" class="type:primaryImage" alt="" /></p>
                <p>Sometimes you choose to send a message through outlook with a digital signature but without enryption. </p>
<p>If you check your sent messages there is a padlock icon next to each message but you've sent the message without encryption : </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/9/outlook-padlock.png" alt="outlook-padlock" width="1033" height="455" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/9/responsive/outlook-padlock-xs.png 300w ,https://drontoso.gr/media/posts/9/responsive/outlook-padlock-sm.png 480w ,https://drontoso.gr/media/posts/9/responsive/outlook-padlock-md.png 768w ,https://drontoso.gr/media/posts/9/responsive/outlook-padlock-lg.png 1024w ,https://drontoso.gr/media/posts/9/responsive/outlook-padlock-xl.png 1360w ,https://drontoso.gr/media/posts/9/responsive/outlook-padlock-2xl.png 1600w"></figure>
<p> </p>
<p>This is happening because the following option is not checked : </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/9/smime-check.png" alt="TrustCenterSettings" width="823" height="669" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/9/responsive/smime-check-xs.png 300w ,https://drontoso.gr/media/posts/9/responsive/smime-check-sm.png 480w ,https://drontoso.gr/media/posts/9/responsive/smime-check-md.png 768w ,https://drontoso.gr/media/posts/9/responsive/smime-check-lg.png 1024w ,https://drontoso.gr/media/posts/9/responsive/smime-check-xl.png 1360w ,https://drontoso.gr/media/posts/9/responsive/smime-check-2xl.png 1600w"></figure>
<p>To resolve the issue navigate to : </p>
<p>Outlook</p>
<p>File - Options - Trust center - Trust Center Settings - Email Security and activate </p>
<p>Send clear text signed message when sending signed messages. </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Exchange Server Databases &quot;Dissappeared&quot;</title>
        <author>
            <name>Ilias Drosos</name>
        </author>
        <link href="https://drontoso.gr/exchange-server-databases-dissappeared/"/>
        <id>https://drontoso.gr/exchange-server-databases-dissappeared/</id>
        <media:content url="https://drontoso.gr/media/posts/6/microsoft-exchange-logo_resized.png" medium="image" />
            <category term="Exchange On Premise"/>

        <updated>2022-07-21T12:31:23+03:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://drontoso.gr/media/posts/6/microsoft-exchange-logo_resized.png" alt="Exchange" />
                    After logging in to exchange on premise (ECP) you might see the picture below when navigating to Servers - &gt; Databases In addition if you check through Exchange management shell you might get the error below or similar like we did : So it seems&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <p><img src="https://drontoso.gr/media/posts/6/microsoft-exchange-logo_resized.png" class="type:primaryImage" alt="Exchange" /></p>
                <p>After logging in to exchange on premise (ECP) you might see the picture below when navigating to Servers - &gt; Databases</p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/6/exc.jpg" alt="" width="881" height="483" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/6/responsive/exc-xs.jpg 300w ,https://drontoso.gr/media/posts/6/responsive/exc-sm.jpg 480w ,https://drontoso.gr/media/posts/6/responsive/exc-md.jpg 768w ,https://drontoso.gr/media/posts/6/responsive/exc-lg.jpg 1024w ,https://drontoso.gr/media/posts/6/responsive/exc-xl.jpg 1360w ,https://drontoso.gr/media/posts/6/responsive/exc-2xl.jpg 1600w"></figure>
<p>In addition if you check through Exchange management shell you might get the error below or similar like we did : </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/6/excdb-2.jpg" alt="" width="950" height="161" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/6/responsive/excdb-2-xs.jpg 300w ,https://drontoso.gr/media/posts/6/responsive/excdb-2-sm.jpg 480w ,https://drontoso.gr/media/posts/6/responsive/excdb-2-md.jpg 768w ,https://drontoso.gr/media/posts/6/responsive/excdb-2-lg.jpg 1024w ,https://drontoso.gr/media/posts/6/responsive/excdb-2-xl.jpg 1360w ,https://drontoso.gr/media/posts/6/responsive/excdb-2-2xl.jpg 1600w"></figure>
<p>So it seems there is an old reference to a database which has been deleted in our case . But why should this interfere with the rest of our Databases?</p>
<p>We deleted the reference to the old database - Make sure it is an old reference which is no longer needed before deletion - by navigating to ADSI Edit : </p>
<p>On a Domain Controller, Open ADSIEdit.msc and Connect to ‘Configuration’.</p>
<p>Navigate to Configuration &gt; Services &gt; Microsoft Exchange &gt; {Organisation name} &gt; Administrative Groups &gt; {Administrative-Group-Name} &gt; Databases  &gt;Delete the old database reference . </p>
<figure class="post__image"><img loading="lazy"  src="https://drontoso.gr/media/posts/6/excADSI.jpg" alt="" width="665" height="327" sizes="(max-width: 48em) 100vw, 768px" srcset="https://drontoso.gr/media/posts/6/responsive/excADSI-xs.jpg 300w ,https://drontoso.gr/media/posts/6/responsive/excADSI-sm.jpg 480w ,https://drontoso.gr/media/posts/6/responsive/excADSI-md.jpg 768w ,https://drontoso.gr/media/posts/6/responsive/excADSI-lg.jpg 1024w ,https://drontoso.gr/media/posts/6/responsive/excADSI-xl.jpg 1360w ,https://drontoso.gr/media/posts/6/responsive/excADSI-2xl.jpg 1600w"> </figure>
<p>After 5 minutes logout and relogin to ECP and check again . Your databases should be visible now :D . </p>
            ]]>
        </content>
    </entry>
</feed>
